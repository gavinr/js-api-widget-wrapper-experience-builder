define(["jimu-core","jimu-ui","jimu-arcgis","jimu-layouts/common","jimu-ui/item-selector"],(function(e,t,n,s,o){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=687)}({0:function(t,n){t.exports=e},106:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M1.521 5.693a.517.517 0 01-.708 0 .464.464 0 010-.677l2.833-2.71a.517.517 0 01.708 0l2.833 2.71a.464.464 0 010 .677.517.517 0 01-.708 0L4 3.323l-2.479 2.37z"></path><path d="M0 0h8v8H0z" fill="none"></path></svg>'},116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=n(22);t.AllDataSourceTypes=Object.assign({},s.DataSourceTypes,o.ArcGISDataSourceTypes)},146:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 9.521L.162 3.981a.592.592 0 010-.813.534.534 0 01.779 0L6 8.448l5.06-5.28a.534.534 0 01.779 0 .592.592 0 010 .813l-5.31 5.54a.726.726 0 01-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(116),o=n(0);function r(e,t,n){e.isDataSourceSet&&e.getChildDataSources().forEach((function(e){e&&e.dataSourceJson&&e.id&&(a(e.dataSourceJson,n)&&t.push(e),r(e,t,n))}))}function a(e,t){return!!e&&t.some((function(t){return e.type&&t===e.type}))}t.traverseGetToUseDss=r,t.getWhetherUseDataSource=a,t.getToUseChildDss=function(e,t){var n={};return 0===t.length?Promise.resolve(n):Promise.all(e.filter((function(e){return e&&e.id&&e.dataSourceJson&&e.isDataSourceSet&&e.ready})).map((function(e){return n[e.id]||(n[e.id]=[]),e.ready().then((function(){return r(e,n[e.id],t)}))}))).then((function(){return Object.keys(n).forEach((function(e){0===n[e].length&&delete n[e]})),n}))},t.getSortedKeys=function(e){return Object.keys(e).sort((function(e,t){return e.localeCompare(t)}))},t.getSortedArrayByLabel=function(e){return e.sort((function(e,t){return e.label.localeCompare(t.label)}))},t.getSortedLabels=function(e){return e.sort((function(e,t){return e.localeCompare(t)}))};var i=[s.AllDataSourceTypes.FeatureSet];t.getAddedDataTypes=function(e){return e?e.filter((function(e){return!i.some((function(t){return t===e}))})):o.Immutable([])},t.getOutputTypes=function(e){return e?e.filter((function(e){return i.some((function(t){return t===e}))})):o.Immutable([])}},148:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 0a.5.5 0 01.5.5V1h2a1 1 0 011 1v9a1 1 0 01-1 1H1a1 1 0 01-1-1V2a1 1 0 011-1h2V.5a.5.5 0 011 0V1h4V.5a.5.5 0 01.5-.5zM11 5H1v6h10V5zM8.5 8.5a.5.5 0 010 1h-5a.5.5 0 010-1h5zm0-2a.5.5 0 010 1h-5a.5.5 0 010-1h5zM3 2H1v2h10V2H9v.5a.5.5 0 01-1 0V2H4v.5a.5.5 0 01-1 0V2z" fill="#000" fill-rule="nonzero"></path></svg>'},190:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 11.943l4 1.711V4.057L6 2.346v9.597zm-1 .17V2.494l-4 1.48v9.619l4-1.48zm6 1.393l4-1.48V2.407l-4 1.48v9.619zM0 15V3.307L5.75 1.18l4.528 1.937L16 1v11.693l-5.75 2.127-4.528-1.937L0 15z" fill="#000" fill-rule="nonzero"></path></svg>'},191:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 4V1.39C6.402 2.12 5.565 2.99 4.985 4H7.5zm0 3.5V5H4.512a8.13 8.13 0 00-.5 2.5H7.5zm0 3.5V8.5H4.012a8.13 8.13 0 00.5 2.5H7.5zm0 3.61V12H4.985c.58 1.01 1.417 1.88 2.515 2.61zm2.543.087A7.014 7.014 0 0013.745 12h-1.6a8.278 8.278 0 01-2.102 2.697zM11.015 12H8.5v2.61c1.098-.73 1.935-1.6 2.515-2.61zm1.974-3.5a9.328 9.328 0 01-.441 2.5h1.778c.365-.767.594-1.61.656-2.5H12.99zm-1.001 0H8.5V11h2.988a8.13 8.13 0 00.5-2.5zm.56-3.5c.254.775.401 1.609.441 2.5h1.993a6.957 6.957 0 00-.656-2.5h-1.778zm-1.06 0H8.5v2.5h3.488a8.13 8.13 0 00-.5-2.5zm-1.445-3.697c.91.78 1.611 1.68 2.102 2.697h1.6a7.014 7.014 0 00-3.702-2.697zM8.5 4h2.515c-.58-1.01-1.417-1.88-2.515-2.61V4zm-.527 12a8 8 0 11.055-16 8 8 0 01-.055 16zM5.957 1.302A7.014 7.014 0 002.255 4h1.6a8.278 8.278 0 012.102-2.697zM3.011 7.5c.04-.891.187-1.725.441-2.5H1.674a6.957 6.957 0 00-.656 2.5H3.01zm.441 3.5a9.328 9.328 0 01-.441-2.5H1.018c.062.89.291 1.733.656 2.5h1.778zm2.505 3.697A8.278 8.278 0 013.855 12h-1.6a7.014 7.014 0 003.702 2.697z" fill="#000" fill-rule="nonzero"></path></svg>'},192:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0l8 6-8 6-8-6 8-6zM1.887 6L8 10.82 14.113 6 8 1.18 1.887 6zM.563 9L8 14.775 15.437 9l.563.81L8 16 0 9.81.563 9z" fill="#000" fill-rule="nonzero"></path></svg>'},193:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M7.25 8.201V14h5.8V8.201h-5.8zM0 14h5.8V8.201H0V14zM0 .953v5.799h5.8V.953H0zM9.9 0L5.8 4.103 9.9 8.2 14 4.103 9.9 0z" fill-rule="nonzero"></path></svg>'},194:function(e,t){e.exports='<svg viewBox="0 0 80 71" xmlns="http://www.w3.org/2000/svg"><path d="M63.86 24a4 4 0 013.327 1.781l12.141 18.211a4 4 0 01.672 2.22V67a4 4 0 01-4 4H4a4 4 0 01-4-4V46.211a4 4 0 01.672-2.219l12.14-18.21A4 4 0 0116.142 24h47.718zm0 4H16.14L4.808 44.999H29a2 2 0 012 2V47c0 .687.077 1.357.223 2l-27.224-.001L4 67h72l-.001-18.001H48.777A9.03 9.03 0 0049 47a2 2 0 012-2.001h23.585L63.859 28zM31.222 49a9.003 9.003 0 0017.554 0h4.07C51.885 55.23 46.499 60 40 60c-6.5 0-11.885-4.77-12.847-11h4.07zm36.42-42.128a2.5 2.5 0 01.307 3.522l-7.07 8.426a2.5 2.5 0 01-3.83-3.214l7.07-8.426a2.5 2.5 0 013.522-.308zM15.88 7.18l7.07 8.426a2.5 2.5 0 01-3.83 3.214l-7.07-8.426a2.5 2.5 0 013.83-3.214zM40 0a2.5 2.5 0 012.5 2.5v14a2.5 2.5 0 11-5 0v-14A2.5 2.5 0 0140 0z" fill="#6A6A6A" fill-rule="evenodd"></path></svg>'},195:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="evenodd"></path></svg>'},22:function(e,t){e.exports=n},294:function(e,t){e.exports=s},3:function(e,n){e.exports=t},301:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 16a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm13 13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zm0-13a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM8 9.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" fill-rule="nonzero"></path></svg>'},302:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.147 13.146l11-11a1.5 1.5 0 11.707.707l-11 11a1.5 1.5 0 11-.707-.707z" fill-rule="nonzero"></path></svg>'},303:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.915 14h10.17c.05-.14.12-.271.207-.389l-2.204-4.114a1.5 1.5 0 110-2.995l2.204-4.113A1.496 1.496 0 0113.085 2H2.915c-.151.426-.489.764-.915.915v10.17c.426.151.764.489.915.915zm0 1A1.5 1.5 0 111 13.085V2.915A1.5 1.5 0 112.915 1h10.17a1.5 1.5 0 111.276 1.994l-2.272 3.975a1.495 1.495 0 010 2.063l2.272 3.974A1.5 1.5 0 1113.086 15H2.914z" fill-rule="nonzero"></path></svg>'},304:function(e,t){e.exports='<svg viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 5.304V6.5C1 7.692 3.615 9 7 9s6-1.308 6-2.5V5.304C11.775 6.32 9.546 7 7 7s-4.775-.68-6-1.696zM14 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C0 1.567 3.134 0 7 0s7 1.567 7 3.5zm-1 4.804C11.775 9.32 9.546 10 7 10s-4.775-.68-6-1.696V9.5C1 10.692 3.615 12 7 12s6-1.308 6-2.5V8.304zm0 3C11.775 12.32 9.546 13 7 13s-4.775-.68-6-1.696V12.5C1 13.692 3.615 15 7 15s6-1.308 6-2.5v-1.196zM7 6c3.385 0 6-1.308 6-2.5S10.385 1 7 1 1 2.308 1 3.5 3.615 6 7 6z" fill="#000" fill-rule="nonzero"></path></svg>'},305:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm0 2C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm8.282-1.718a.961.961 0 011.359 0l4.077 4.077a.961.961 0 01-1.359 1.36l-4.077-4.078a.961.961 0 010-1.36z" fill="#000" fill-rule="nonzero"></path></svg>'},306:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 15a.5.5 0 010 1h-9a.5.5 0 010-1h9zM2 0a.5.5 0 01.5.5V14l.6-.8a.5.5 0 01.623-.147l.077.047a.5.5 0 01.148.623L3.9 13.8l-1.5 2a.5.5 0 01-.734.072L1.6 15.8l-1.5-2a.5.5 0 01.74-.667l.06.067.6.8V.5A.5.5 0 012 0zm10.5 10a.5.5 0 010 1h-6a.5.5 0 010-1h6zm-2-5a.5.5 0 010 1h-4a.5.5 0 010-1h4zm-2-5a.5.5 0 010 1h-2a.5.5 0 010-1h2z" fill="#000" fill-rule="evenodd"></path></svg>'},307:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 15a.5.5 0 010 1h-9a.5.5 0 010-1h9zm-3-5a.5.5 0 010 1h-6a.5.5 0 010-1h6zm-2-5a.5.5 0 010 1h-4a.5.5 0 010-1h4zm-2-5a.5.5 0 010 1h-2a.5.5 0 010-1h2zM2 16a.5.5 0 00.5-.5V2l.6.8a.5.5 0 00.623.147L3.8 2.9a.5.5 0 00.148-.623L3.9 2.2 2.4.2a.5.5 0 00-.734-.072L1.6.2l-1.5 2a.5.5 0 00.74.667L.9 2.8l.6-.8v13.5a.5.5 0 00.5.5z" fill="#000" fill-rule="evenodd"></path></svg>'},308:function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13.462 12l10.235 10.235a1.034 1.034 0 11-1.462 1.462L12 13.462 1.765 23.697a1.034 1.034 0 11-1.462-1.462L10.538 12 .303 1.765A1.034 1.034 0 111.765.303L12 10.538 22.235.303a1.034 1.034 0 111.462 1.462L13.462 12z" fill="#000" fill-rule="nonzero"></path></svg>'},309:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M5.47 3.229L.162 8.769a.592.592 0 000 .813.534.534 0 00.779 0L6 4.302l5.06 5.28a.534.534 0 00.779 0 .592.592 0 000-.813l-5.31-5.54a.726.726 0 00-1.058 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},310:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.262 6.972l-.893-.893a.5.5 0 010-.707l.003-.003a.5.5 0 01.707 0l.893.893.709-.709a1.003 1.003 0 000-1.419L4.844 1.297a1.003 1.003 0 00-1.419 0L1.297 3.425a1.003 1.003 0 000 1.419L4.134 7.68a1.003 1.003 0 001.419 0l.71-.71zm1.419 0l1.347 1.347.71-.71a2.006 2.006 0 012.837 0l2.837 2.838a2.006 2.006 0 010 2.837l-2.128 2.128a2.006 2.006 0 01-2.837 0L7.61 12.575a2.006 2.006 0 010-2.837l.709-.71-1.347-1.347-.71.71a2.006 2.006 0 01-2.837 0L.588 5.552a2.006 2.006 0 010-2.837L2.716.588a2.006 2.006 0 012.837 0L8.39 3.425a2.006 2.006 0 010 2.837l-.709.71zm2.057 2.056l.599.6a.5.5 0 010 .707l-.002.002a.5.5 0 01-.707 0l-.6-.6-.709.71a1.003 1.003 0 000 1.419l2.837 2.837a1.003 1.003 0 001.419 0l2.128-2.128a1.003 1.003 0 000-1.419L11.866 8.32a1.003 1.003 0 00-1.419 0l-.71.71z" fill="#000" fill-rule="nonzero"></path></svg>'},311:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 3.5v-3a.5.5 0 011 0v3h3a.5.5 0 010 1h-3v3a.5.5 0 01-1 0v-3h-3a.5.5 0 010-1h3z" fill-rule="evenodd"></path></svg>'},312:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M4 10v1H0v-1h4zm2-3v1H0V7h6zm3-3v1H0V4h9zm3-3v1H0V1h12z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},313:function(e,t){e.exports='<svg viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h12v1.34h-.053L7.333 5.971V14l-2.666-2.678V5.966L.06 1.339H0z" fill-rule="evenodd"></path></svg>'},314:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M9.5 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zm-4.75 0a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0zM0 6.25a1.25 1.25 0 112.5 0 1.25 1.25 0 01-2.5 0z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},315:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M11 0v6h-1V1H1v10h5v1H0V0h11zM8.5 6a2.5 2.5 0 012.099 3.859l1.248 1.25a.522.522 0 11-.739.738l-1.25-1.248A2.5 2.5 0 118.5 6zm0 1a1.5 1.5 0 10.84 2.742l-.03.019.031-.02.034-.024.028-.02c.021-.015.041-.031.06-.048l-.057.045.082-.065a1.51 1.51 0 00.214-.23l.039-.057.001-.001.015-.024.014-.022.003-.005.008-.012.034-.058.003-.006A1.5 1.5 0 008.5 7zM5 7v1H2V7h3zm1-2v1H2V5h4zm3-2v1H2V3h7z" fill-rule="nonzero" fill="#000"></path></svg>'},316:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M12.8 8L14 9l-7 5-7-5 1.2-1L7 12l5.8-4zM7 0l7 5-7 5-7-5 7-5z" fill-rule="evenodd"></path></svg>'},317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=n(318),r=n(319),a=n(148);t.getIconFromFieldType=function(e,t){var n,i;if(!e||!t)return null;var l=((n={})[s.JimuFieldType.Number]=o,n[s.JimuFieldType.String]=r,n[s.JimuFieldType.Date]=a,n),c=((i={})[s.JimuFieldType.Number]=t.colors.info,i[s.JimuFieldType.String]=t.colors.success,i[s.JimuFieldType.Date]=t.colors.warning,i);return{icon:l[e],color:c[e]}}},318:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.6 4.23L.553 5.238 0 4.558l1.687-1.46h.86v5.804H1.6V4.23zm2.035 3.63l2.168-2.18L6 5.471c.068-.073.13-.151.185-.233.055-.082.101-.168.138-.258a.741.741 0 00.055-.283.729.729 0 00-.244-.558.786.786 0 00-.256-.151.9.9 0 00-.312-.054.822.822 0 00-.583.214.918.918 0 00-.276.573l-.993-.082c.02-.267.082-.504.185-.709.102-.205.235-.375.398-.512.163-.137.352-.24.568-.311A2.23 2.23 0 015.566 3c.253 0 .488.034.706.102.218.069.409.17.572.304.163.134.291.304.386.512.095.208.142.45.142.73 0 .366-.08.681-.24.946-.16.265-.367.518-.62.758L4.786 8.016h2.586v.886H3.635V7.86zm5.952-2.426h.245c.136 0 .27-.008.398-.024a.999.999 0 00.347-.107.64.64 0 00.248-.237.8.8 0 00.095-.418.73.73 0 00-.22-.55.794.794 0 00-.576-.213.828.828 0 00-.509.168.948.948 0 00-.327.472l-1.002-.28c.064-.212.153-.398.269-.556.115-.159.252-.289.41-.39.157-.1.33-.176.52-.225.19-.05.386-.074.591-.074.242 0 .47.033.686.098.216.066.405.163.568.291a1.412 1.412 0 01.536 1.16c0 .312-.084.589-.252.832a1.177 1.177 0 01-.702.48v.016c.357.055.628.213.812.475.184.263.276.574.276.935 0 .279-.051.524-.154.738-.102.213-.24.392-.414.536a1.786 1.786 0 01-.603.328 2.31 2.31 0 01-.713.111c-.232 0-.45-.026-.655-.078a1.805 1.805 0 01-.556-.242 1.602 1.602 0 01-.43-.422A1.91 1.91 0 018.2 7.64l1.009-.278c.058.24.16.426.307.557.148.131.347.197.6.197a.986.986 0 00.658-.25.855.855 0 00.205-.287.906.906 0 00.075-.373.822.822 0 00-.114-.455.781.781 0 00-.292-.27 1.225 1.225 0 00-.398-.128 2.95 2.95 0 00-.434-.032h-.229v-.886z" fill="#000" fill-rule="nonzero"></path></svg>'},319:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.804 3.145h.638l1.786 5.71h-.843L3 7.548H1.2L.826 8.855H0l1.804-5.71zm.937 3.532l-.639-2.322-.65 2.322h1.289zm1.95-3.532h1.616c.157 0 .31.026.463.077.152.05.288.134.407.25.12.115.216.265.29.447.074.183.111.404.111.662 0 .322-.066.588-.199.798-.133.21-.306.36-.521.452v.016a.871.871 0 01.36.149c.111.078.206.177.284.298.078.121.14.261.185.42.045.158.067.329.067.512 0 .312-.045.571-.135.778-.09.207-.208.374-.354.5a1.308 1.308 0 01-.504.27c-.189.054-.381.08-.577.08H4.691V3.146zm.738 2.323h.673c.246 0 .43-.066.554-.198a.731.731 0 00.184-.52c0-.247-.063-.431-.19-.552-.127-.121-.33-.182-.612-.182H5.43v1.452zm0 2.516h.68c.093 0 .194-.008.301-.024a.675.675 0 00.518-.367.96.96 0 00.088-.448c0-.3-.071-.51-.214-.629-.142-.118-.364-.177-.664-.177h-.709v1.645zm5.903-3.5c-.152-.226-.3-.376-.442-.452a.914.914 0 00-.43-.113c-.215 0-.41.053-.583.158-.174.104-.323.25-.448.435a2.203 2.203 0 00-.29.65 2.988 2.988 0 00-.102.798c0 .306.034.588.102.846.068.259.165.482.29.67.125.188.274.336.448.443.174.108.368.162.583.162.168 0 .33-.055.489-.166.158-.11.305-.286.442-.528l.609.597c-.187.355-.416.613-.685.774-.27.161-.557.242-.861.242-.32 0-.614-.071-.882-.214a2.064 2.064 0 01-.69-.605 3.012 3.012 0 01-.454-.94 4.241 4.241 0 01-.164-1.217c0-.457.054-.872.164-1.246.109-.373.26-.692.453-.955.194-.264.424-.467.691-.61.268-.142.562-.213.882-.213.281 0 .542.069.782.206.24.137.463.37.67.697l-.574.58z" fill="#000" fill-rule="nonzero"></path></svg>'},34:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.598L14.308.29a.991.991 0 011.402 1.402L9.402 8l6.308 6.308a.991.991 0 01-1.402 1.402L8 9.402 1.692 15.71A.991.991 0 01.29 14.308L6.598 8 .29 1.692A.991.991 0 011.692.29L8 6.598z" fill="#000" fill-rule="nonzero"></path></svg>'},35:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},38:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M4.586 8.657l6.01-6.01a.5.5 0 01.707.707l-6.01 6.01a1 1 0 01-1.414 0L.697 6.182a.5.5 0 01.707-.707l3.182 3.182z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},418:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(419),l=n(702),c=n(705),d=n(116),p=n(34),u=n(311),h=n(195),m=function(e){function t(t){var n=e.call(this,t)||this;return n.externalDsStyle={width:"100%",height:"100%",maxWidth:"5000px",margin:0},n.__unmount=!1,n.showExternalDs=function(){n.setState({isExternalDsShown:!0})},n.onSelectDataFinished=function(e){e?n.state.getAppConfigAction?((0,n.state.getAppConfigAction)().addDataSources(e).exec(),e.map((function(e){return r.DataSourceManager.getInstance().createDataSource(e)})),n.props.changeInitStatus&&n.props.changeInitStatus(!1),n.setState({isExternalDsShown:!1})):console.error("Can not load jimu-for-builder"):n.setState({isExternalDsShown:!1})},n.onSelectDataCanceled=function(){n.setState({isExternalDsShown:!1})},n.onToggleExternalDs=function(){n.setState({isExternalDsShown:!n.state.isExternalDsShown})},n.onSearchValueChange=function(e){n.setState({searchValue:e.target.value})},n.ExternalDs=r.jsx(i.ExternalDataSourceSelector,{portalUrl:r.getAppStore().getState().portalUrl,onCancel:n.onSelectDataCanceled,onFinish:n.onSelectDataFinished,types:n.props.types&&n.props.types.some((function(e){return e===d.AllDataSourceTypes.FeatureLayer||e===d.AllDataSourceTypes.FeatureQuery}))?null:n.props.types}),n.state={isExternalDsShown:!1,getAppConfigAction:null,searchValue:""},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,r.moduleLoader.loadModule("jimu-for-builder").then((function(t){e.__unmount||e.setState({getAppConfigAction:t.getAppConfigAction})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.getWhetherOnlyUseAddedData=function(e){var t=this;return!!e&&e.every((function(e){return!t.getWhetherOneTypeIsOutput(e)}))},t.prototype.getWhetherOnlyUseWidgetOutput=function(e){var t=this;return!!e&&e.every((function(e){return t.getWhetherOneTypeIsOutput(e)}))},t.prototype.getWhetherOneTypeIsOutput=function(e){var t=r.DataSourceManager.getInstance().getDataSources();return Object.keys(t).some((function(n){return t[n]&&t[n].type===e&&t[n].dataSourceJson&&t[n].dataSourceJson.isOutputFromWidget}))},t.prototype.render=function(){var e,t=r.jsx(c.default,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,selectedDsIds:this.props.selectedDsIds,onRemove:this.props.onRemove,onSelect:this.props.onSelect,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,searchValue:this.state.searchValue,fromDsIds:this.props.fromDsIds,dataSources:this.props.dataSources}),n=r.jsx(l.default,{types:this.props.types,isDataSourceInited:this.props.isDataSourceInited,selectedDsIds:this.props.selectedDsIds,onRemove:this.props.onRemove,onSelect:this.props.onSelect,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,fromRootDsIds:this.props.fromRootDsIds,hideTypeDropdown:this.props.hideTypeDropdown,searchValue:this.state.searchValue,dataSources:this.props.dataSources}),s=r.jsx(a.Tabs,{pills:!0,fill:!0,className:"mt-3"},r.jsx(a.Tab,{title:this.props.intl.formatMessage({id:"added",defaultMessage:a.defaultMessages.added}),active:!0},t),r.jsx(a.Tab,{title:this.props.intl.formatMessage({id:"outputs",defaultMessage:a.defaultMessages.outputs})},n)),o=this.getWhetherOnlyUseAddedData(this.props.types),i=this.getWhetherOnlyUseWidgetOutput(this.props.types);return r.jsx("div",{className:r.classNames("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},r.jsx("div",{className:"component-data-source-list h-100 w-100"},!this.props.hideHeader&&r.jsx("div",{className:"ds-list-header jimu-widget-setting--header d-flex px-3 py-0",title:this.props.intl.formatMessage({id:"setDataSource",defaultMessage:a.defaultMessages.setDataSource})},r.jsx("div",{className:"flex-grow-1 text-truncate d-flex align-items-center"},r.jsx("span",null,this.props.intl.formatMessage({id:"setDataSource",defaultMessage:a.defaultMessages.setDataSource}))),this.props.onCloseClick&&r.jsx(a.Button,{type:"tertiary",size:"sm",icon:!0,className:"flex-shrink-0 text-center ds-list-close px-2 d-flex align-items-center",onClick:this.props.onCloseClick},r.jsx(a.Icon,{icon:p,size:"16"}))),r.jsx("div",{className:"w-100 px-3 search"},r.jsx(a.Icon,{icon:h,size:16,className:"search-icon"}),r.jsx(a.TextInput,{value:this.state.searchValue,onChange:this.onSearchValueChange,className:"search-input",placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:r.defaultMessages.search})})),r.jsx("div",{className:"w-100 ds-list-container"},r.jsx("div",{className:"ds-list-tabs h-100"},o?t:r.jsx("div",{className:"h-100"},i?n:s)),!this.props.hideAddData&&r.jsx("div",{className:" d-flex align-items-center px-3 ds-add-data",onClick:this.showExternalDs},r.jsx("div",{className:"add-data-icon-container d-flex align-items-center justify-content-center mr-2"},r.jsx(a.Icon,{icon:u,size:12,className:"add-data-icon"})),r.jsx("div",{className:"text-truncate flex-grow-1"},this.props.intl.formatMessage({id:"addNewData",defaultMessage:a.defaultMessages.addNewData})))),this.props.isDataSourceInited?null:r.jsx("div",{className:"jimu-secondary-loading"})),this.state.isExternalDsShown?r.jsx(a.Modal,{isOpen:this.state.isExternalDsShown,style:this.externalDsStyle,toggle:this.onToggleExternalDs,contentClassName:"h-100",className:"widget-ds-setting-add-data-popup"},this.ExternalDs):null)},t}(r.React.PureComponent);t.DataSourceList=r.themeUtils.withStyles(r.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources}}))(r.injectIntl(m)),"DataSourceList")},419:function(e,t,n){"use strict";var s,o,r,a,i=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=this&&this.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var c,d=n(0),p=n(3),u=n(22),h=n(698),m=n(420),f=n(700),g=n(701),v=n(421),S=n(69),y=n(308),b=n(35),D=n(146),x=n(309);!function(e){e.Url="URL"}(c||(c={}));var w=l(l(l({},d.DataSourceTypes),u.ArcGISDataSourceTypes),h.HubDataSourceTypes),I=l(l({},m.ItemTypes),c),M=((o={})[m.ItemTypes.WebMap]=w.WebMap,o[m.ItemTypes.WebScene]=w.WebScene,o[m.ItemTypes.FeatureService]=w.FeatureQuery,o),j=((r={})[w.WebMap]=I.WebMap,r[w.WebScene]=I.WebScene,r[w.FeatureLayer]=I.FeatureService,r[w.FeatureQuery]=[I.FeatureService,I.Url],r),_=((a={})[I.WebMap]=n(190),a[I.WebScene]=n(191),a[I.FeatureService]=n(192),a[I.Url]=n(310),a),R=function(e){function t(t){var n,s=e.call(this,t)||this;return s.tabLabel=((n={})[I.WebMap]=s.props.intl.formatMessage({id:"webMap",defaultMessage:p.defaultMessages.webMap}),n[I.WebScene]=s.props.intl.formatMessage({id:"webScene",defaultMessage:p.defaultMessages.webScene}),n[I.FeatureService]=s.props.intl.formatMessage({id:"featureLayer",defaultMessage:p.defaultMessages.featureLayer}),n[I.Url]=s.props.intl.formatMessage({id:"url",defaultMessage:p.defaultMessages.url}),n),s.getDsTypeFromItemType=function(e){return e?M[e]:null},s.getTabTypeFromDsType=function(e){return e?Array.isArray(j[e])?j[e]:[j[e]]:[]},s.getTabIcon=function(e){return e?_[e]:null},s.getTabLabel=function(e){return e?s.tabLabel[e]:null},s.getElementPosition=function(e){if(!e)return null;for(var t=e.offsetLeft,n=e.offsetTop,s=e.offsetParent;null!==s;)t+=s.offsetLeft,n+=s.offsetTop,s=s.offsetParent;return{x:t,y:n}},s.getItemDetailPosition=function(){var e,t,n;if(!s.rootDom)return null;var o=s.getElementPosition(s.rootDom),r=null===(n=null===(t=null===(e=d.getAppStore())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.appContext)||void 0===n?void 0:n.isRTL,a=o.x+260;return{t:"0",b:"0",l:r?"auto":a+"px",r:r?a+"px":"auto",w:"260px",h:"auto"}},s.getConfigDsId=function(){var e=d.getAppStore().getState(),t=e&&e.appStateInBuilder&&e.appStateInBuilder.appConfig;return d.appConfigUtils.getUniqueId(t,"dataSource")},s.getNextDsId=function(){if(!s.dataSourceId)return s.dataSourceId=s.getConfigDsId(),s.dataSourceId;var e=s.dataSourceId.split("_"),t=e[1]?parseInt(e[1])+1:d.uuidv1(),n=e[0]||"dataSource";return s.dataSourceId=n+"_"+t,s.dataSourceId},s.getDsJsonsFromItem=function(e){var t,n=[];if(!e)return Promise.resolve(n);var o=s.getDsTypeFromItemType(e.type);return e.url&&o===w.FeatureQuery&&!v.isFeatureLayerUrl(e.url)?d.ServiceManager.getInstance().fetchServiceInfo(e.url).then((function(o){var r=o.definition;if(r&&r.layers)return Promise.all(r.layers.map((function(t){return d.ServiceManager.getInstance().fetchServiceInfo(""+v.getDsJsonUrl(e.url,t,!0)).then((function(e){return e.definition}))}))).then((function(o){return o.forEach((function(o){o&&o.type&&o.type===v.FEATURE_LAYER_TYPE&&(t=v.getSingleDsJsonFromLayer(e.url,s.getNextDsId(),o,!0))&&(t=t.set("itemId",e.id).set("portalUrl",s.props.portalUrl),n.push(t))})),n}))}),(function(e){return console.error(e),n})):(t=s.getSingleDsJsonFromItem(e),n=[t],Promise.resolve(n))},s.getSingleDsJsonFromItem=function(e){if(!e)return null;var t=d.Immutable({type:s.getDsTypeFromItemType(e.type),itemId:e.id,id:s.getNextDsId(),label:e.title,portalUrl:s.props.portalUrl});if(e.url){var n=e.url.replace(/\/$/,"").split("/");t=t.set("url",e.url).set("layerId",n[n.length-1])}return t},s.onItemAdded=function(e,t){void 0===e&&(e=[]),s.setState({loaded:!1,selectedItems:e,partSelectedItems:s.state.partSelectedItems.filter((function(t){return!e.some((function(e){return e.id===t.id}))}))}),s.getDsJsonsFromItem(t).then((function(e){s.props.onSelect&&s.props.onSelect(e),s.setState({selectedDss:s.state.selectedDss.concat(e),loaded:!0})}),(function(e){console.error(e),s.setState({loaded:!0})}))},s.onItemRemoved=function(e,t){s.setState({loaded:!1,selectedItems:e,partSelectedItems:s.state.partSelectedItems.filter((function(e){return e.id!==t.id}))}),s.getDsJsonsFromItem(t).then((function(e){s.props.onRemove&&s.props.onRemove(e),s.setState({selectedDss:s.state.selectedDss.filter((function(t){return e.every((function(e){return t.itemId!==e.itemId}))})),loaded:!0})}),(function(e){console.error(e),s.setState({loaded:!0})}))},s.onDsJsonAdded=function(e){s.props.onSelect&&s.props.onSelect(e),s.setState({selectedDss:s.state.selectedDss.concat(e)})},s.onDsJsonRemoved=function(e){s.props.onRemove&&s.props.onRemove([e]),s.setState({selectedDss:s.state.selectedDss.filter((function(t){return t.id!==e.id})),selectedItems:s.state.selectedItems.filter((function(t){return e.itemId&&t.id!==e.itemId})),partSelectedItems:s.getPartSelectedItems(e)})},s.onAddedDataCollapseClicked=function(){s.setState({isSelectedDataCollapseOpen:!s.state.isSelectedDataCollapseOpen})},s.getPartSelectedItems=function(e){var t=s.state.selectedItems.find((function(t){return e.itemId&&t.id===e.itemId})),n=t&&s.state.selectedDss.filter((function(e){return e.itemId&&e.itemId===t.id})),o=s.state.partSelectedItems.find((function(t){return e.itemId&&t.id===e.itemId})),r=o&&s.state.selectedDss.filter((function(e){return e.itemId&&e.itemId===o.id})),a=s.state.partSelectedItems;return n&&n.length>1&&(a=a.concat(t)),r&&1===r.length&&(a=a.filter((function(e){return e.id!==o.id}))),a},s.getDsLabel=function(e){return e&&(e.label||e.id)},s.onFinish=function(){s.props.onFinish&&s.props.onFinish(s.state.selectedDss.map((function(e){return e&&e.without("geometryType")})))},s.onActiveTabChange=function(e){s.setState({activeTab:e})},s.onMouseEnterAddedDsItem=function(e){s.setState({hoveringAddedItemId:e})},s.onMouseLeaveAddedDsItem=function(){s.setState({hoveringAddedItemId:null})},s.AddedItem=function(e){var t,n=e.dsJson,o=e.onRemoved,r=(e.onDetailClicked,s.state.hoveringAddedItemId&&s.state.hoveringAddedItemId===(null===(t=n)||void 0===t?void 0:t.id));return d.jsx("div",{className:"m-3 added-ds-item",onMouseEnter:function(){var e;return s.onMouseEnterAddedDsItem(null===(e=n)||void 0===e?void 0:e.id)},onMouseLeave:s.onMouseLeaveAddedDsItem},d.jsx("div",{className:"d-flex align-items-center w-100 item"},d.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},d.jsx(p.Icon,{icon:S.getDsIcon(n),className:"text-dark",size:"12"})),d.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},d.jsx("div",{className:"text-truncate ds-type-name",title:s.getDsLabel(n)},s.getDsLabel(n))),r&&d.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 remove"},d.jsx(p.Button,{type:"tertiary",size:"sm",icon:!0,onClick:function(){return o&&o(n)},title:s.props.intl.formatMessage({id:"remove",defaultMessage:p.defaultMessages.remove})},d.jsx(p.Icon,{icon:b,size:12})))))},s.state={selectedDss:[],selectedItems:[],partSelectedItems:[],activeTab:s.props.types&&s.getTabTypeFromDsType(s.props.types[0])?s.getTabTypeFromDsType(s.props.types[0])[0]:I.WebMap,loaded:!0,isSelectedDataCollapseOpen:!1,hoveringAddedItemId:null},s}return i(t,e),t.prototype.render=function(){var e,t=this,n=this.AddedItem,s=this.props.types?Array.prototype.concat.apply([],this.props.types.map((function(e){return t.getTabTypeFromDsType(e)})).filter((function(e){return!!e}))):Object.keys(I).map((function(e){return I[e]}));return d.jsx("div",{className:d.classNames("h-100",(e={},e[this.props.className]=!!this.props.className,e))},d.jsx("div",{className:"w-100 component-external-data-source-selector",ref:function(e){return t.rootDom=e}},d.jsx("div",{className:"d-flex flex-wrap align-items-stretch w-100 h-100"},d.jsx("div",{className:"selector-left"},d.jsx("h3",{className:"selector-left-title"},this.props.isRadio?this.props.intl.formatMessage({id:"selectData",defaultMessage:p.defaultMessages.selectData}):this.props.intl.formatMessage({id:"addData",defaultMessage:p.defaultMessages.addData})),d.jsx(p.Nav,{underline:!0,vertical:!0,right:!0,className:"selector-left-tabs"},s.map((function(e){return d.jsx(p.NavItem,{key:e,className:d.classNames("w-100 mb-2",{"active-tab":t.state.activeTab===e})},d.jsx(p.NavLink,{onClick:function(){t.onActiveTabChange(e)}},d.jsx(p.Icon,{icon:t.getTabIcon(e),size:"16",className:"mr-2"}),t.getTabLabel(e)))})))),d.jsx("div",{className:"selector-right h-100"},d.jsx("div",{className:"selector-right-header w-100 d-flex justify-content-end"},d.jsx(p.Button,{type:"tertiary",size:"sm",icon:!0,className:"close-icon",onClick:this.props.onCancel},d.jsx(p.Icon,{width:20,height:20,icon:y}))),d.jsx("div",{className:"selector-right-body w-100"},Object.keys(m.ItemTypes).map((function(e,n){return d.jsx("div",{className:d.classNames("inner-item-selector-container h-100 w-100",{"d-none":m.ItemTypes[e]!==t.state.activeTab}),key:n},d.jsx(g.default,{itemType:m.ItemTypes[e],intl:t.props.intl,portalUrl:t.props.portalUrl,isRadio:t.props.isRadio,onSelect:t.onItemAdded,onRemove:t.onItemRemoved,getItemDetailPosition:t.getItemDetailPosition,selectedItems:t.state.selectedItems,partSelectedItems:t.state.partSelectedItems}))})),this.state.activeTab===I.Url&&d.jsx(f.default,{onAdded:this.onDsJsonAdded,onRemoved:this.onDsJsonRemoved,getDsId:this.getNextDsId,intl:this.props.intl})))),d.jsx("div",null,this.state.selectedDss&&this.state.selectedDss.length>0&&d.jsx("div",{className:"added-ds-container py-3"},d.jsx("div",{className:"d-flex justify-content-between align-items-center px-3"},d.jsx("div",{className:"d-flex align-items-center"},d.jsx("span",{className:"mr-2"},this.state.selectedDss.length),d.jsx("span",{className:"mr-2"},this.props.intl.formatMessage({id:"selected",defaultMessage:p.defaultMessages.selected})),d.jsx(p.Button,{type:"tertiary",size:"sm",icon:!0,onClick:this.onAddedDataCollapseClicked,title:this.state.isSelectedDataCollapseOpen?this.props.intl.formatMessage({id:"down",defaultMessage:p.defaultMessages.down}):this.props.intl.formatMessage({id:"up",defaultMessage:p.defaultMessages.up})},this.state.isSelectedDataCollapseOpen?d.jsx(p.Icon,{icon:D,size:"12"}):d.jsx(p.Icon,{icon:x,size:"12"}))),d.jsx("div",{className:"small-done-btn"},!this.state.isSelectedDataCollapseOpen&&d.jsx(p.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100"},this.props.intl.formatMessage({id:"done",defaultMessage:p.defaultMessages.done})))),this.state.isSelectedDataCollapseOpen&&d.jsx("div",{className:"added-ds-items"},d.jsx("div",null,this.state.selectedDss.map((function(e,s){return d.jsx(n,{key:s,dsJson:e,onRemoved:t.onDsJsonRemoved})})))),this.state.isSelectedDataCollapseOpen&&d.jsx("div",{className:"big-done-btn w-100 px-3"},d.jsx(p.Button,{onClick:this.onFinish,type:"primary",className:"text-truncate w-100"},this.props.intl.formatMessage({id:"done",defaultMessage:p.defaultMessages.done}))))),d.jsx("div",null,!this.state.loaded&&d.jsx("div",{className:"jimu-primary-loading"}))))},t}(d.React.PureComponent);t.ExternalDataSourceSelector=d.injectIntl(d.themeUtils.withStyles(R,"ExternalDataSourceSelector"))},420:function(e,t){e.exports=o},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=n(116);function r(e,t,n){var s=e&&e.split("?")[0];return s=s&&s.replace(/^http:/,"https:"),n?/\/$/.test(s)?""+s+t.id:s+"/"+t.id:s.replace(/\/$/,"")}t.isFeatureLayerUrl=function(e){return!!(e&&/^(http(s)?:)?\/\//.test(e)&&/\/\d+\/?$/.test(e))},t.FEATURE_LAYER_TYPE="Feature Layer",t.getDsJsonUrl=r,t.getSingleDsJsonFromLayer=function(e,t,n,a){return n?s.Immutable({id:t,type:o.AllDataSourceTypes.FeatureQuery,label:n.name,url:r(e,n,a),geometryType:n.geometryType,layerId:n.id}):null}},422:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(423),i=n(703),l=n(704),c=n(147),d=function(e){function t(t){var n=e.call(this,t)||this;return n.dsManager=r.DataSourceManager.getInstance(),n.getWhetherShowSingleDss=function(){return n.props.singleDss&&n.props.singleDss.length>0},n.getWhetherShowGroupedDss=function(){return n.props.groupedDss&&Object.keys(n.props.groupedDss).length>0},n.getSelectedErrorDss=function(){return n.props.selectedDsIds?n.props.selectedDsIds.asMutable().filter((function(e){return!(n.dsManager&&n.dsManager.getDataSource(e))})):null},n.state={isTypeDropdownOpen:!1,selectedErrorDss:null},n}return o(t,e),t.prototype.componentDidMount=function(){if(this.props.showErrorDss){var e=this.getSelectedErrorDss();this.setState({selectedErrorDss:e}),e&&e.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.componentDidUpdate=function(e){if(this.props.showErrorDss&&(!this.state.selectedErrorDss||0===this.state.selectedErrorDss.length)&&(!e.selectedDsIds||0===e.selectedDsIds.length)&&this.props.selectedDsIds&&0!==this.props.selectedDsIds.length){var t=this.getSelectedErrorDss();this.setState({selectedErrorDss:t}),t&&t.length>0?this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!0):this.props.changeHasErrorSelectedDss&&this.props.changeHasErrorSelectedDss(!1)}},t.prototype.render=function(){var e=this;return r.React.createElement("div",{className:"ds-list"},this.props.showErrorDss&&this.state.selectedErrorDss&&this.state.selectedErrorDss.map((function(t){return r.React.createElement(i.default,{selectedDsIds:e.props.selectedDsIds,dsId:t,onRemove:e.props.onRemove,key:t,onSelect:e.props.onSelect,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl})})),this.getWhetherShowSingleDss()?r.React.createElement("div",{className:"mb-3"},c.getSortedArrayByLabel(this.props.singleDss).map((function(t){return t&&t.id?r.React.createElement(a.default,{selectedDsIds:e.props.selectedDsIds,ds:t,onRemove:e.props.onRemove,key:t.id,onSelect:e.props.onSelect,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove,intl:e.props.intl}):null}))):null,this.getWhetherShowGroupedDss()?r.React.createElement("div",null,c.getSortedKeys(this.props.groupedDss).map((function(t){return e.props.groupedDss[t].some((function(e){return e&&e.id}))?r.React.createElement("div",{key:t,className:"mb-3"},r.React.createElement(l.default,{label:e.props.getGroupLabelById(t),childDss:e.props.groupedDss[t],selectedDsIds:e.props.selectedDsIds,onSelect:e.props.onSelect,onRemove:e.props.onRemove,intl:e.props.intl,icon:e.props.getGroupIconById&&e.props.getGroupIconById(t),disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove})):null}))):null)},t}(r.React.PureComponent);t.default=d},423:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(69),l=n(38),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.selectedDsIds&&t.props.selectedDsIds.some((function(e){return e===t.props.ds.dataSourceJson.id}))},t.getDsJsonWithRootId=function(){var e=t.props.ds.getRootDataSource&&t.props.ds.getRootDataSource(),n={dataSourceJson:t.props.ds.dataSourceJson};return e&&(n.rootDataSourceId=e.id),n},t.getDsLabel=function(e){return e&&e.dataSourceJson&&(e.dataSourceJson.label||e.dataSourceJson.id)},t.onItemClick=function(e){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.props.onRemove&&t.props.onRemove(t.getDsJsonWithRootId())}else{if(t.props.disableSelection)return;t.props.onSelect&&t.props.onSelect(t.getDsJsonWithRootId())}},t}return o(t,e),t.prototype.render=function(){if(!this.props.ds||!this.props.ds.dataSourceJson)return null;var e=this.getWhetherSelected();return r.React.createElement("div",{onClick:this.onItemClick,className:r.classNames("mb-3 ds-item",{"ds-item-selected":e})},r.React.createElement("div",{className:"d-flex align-items-center w-100 item"},r.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},r.React.createElement(a.Icon,{icon:i.getDsIcon(this.props.ds.dataSourceJson),className:"text-dark",size:"12"})),r.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},r.React.createElement("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(this.props.ds)},this.getDsLabel(this.props.ds))),e&&r.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 selected"},r.React.createElement(a.Icon,{icon:l,className:"selected-icon",size:16}))))},t}(r.React.PureComponent);t.default=c},424:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(147),l=n(116),c=n(69),d=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.getWhetherdisableSelectionType=function(e){return e.length<=1},n.onTypeSelected=function(e){var t,s=e.target.value;"All"===s?t=null:s===l.AllDataSourceTypes.FeatureLayer||s===l.AllDataSourceTypes.FeatureQuery?(t=[s],n.props.toUseTypes.some((function(e){return e===l.AllDataSourceTypes.FeatureLayer}))&&n.props.toUseTypes.some((function(e){return e===l.AllDataSourceTypes.FeatureQuery}))&&(t=[l.AllDataSourceTypes.FeatureLayer,l.AllDataSourceTypes.FeatureQuery])):t=[s],n.props.onTypeSelected(t)},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.toUseTypes||r.Immutable([]);return t.some((function(e){return e===l.AllDataSourceTypes.FeatureLayer}))&&t.some((function(e){return e===l.AllDataSourceTypes.FeatureQuery}))&&(t=t.filter((function(e){return e!==l.AllDataSourceTypes.FeatureLayer}))),r.React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3 to-use-types"},r.React.createElement("div",{className:"mr-2 w-25 text-truncate",title:this.props.intl.formatMessage({id:"type",defaultMessage:a.defaultMessages.type})},this.props.intl.formatMessage({id:"type",defaultMessage:a.defaultMessages.type})),this.getWhetherdisableSelectionType(t)?r.React.createElement("div",{className:"types-selected text-truncate mr-1",title:c.getDsTypeString(t[0],this.props.intl)},c.getDsTypeString(t[0],this.props.intl)):r.React.createElement(a.Select,{value:this.props.selectedTypes&&this.props.selectedTypes[0]||"All",onChange:this.onTypeSelected,className:"flex-shrink-0 to-use-dp",buttonProps:{className:"text-truncate h-100"}},i.getSortedLabels(t.asMutable()).map((function(t){return r.React.createElement("option",{value:t,key:t},c.getDsTypeString(t,e.props.intl))})),t&&t.length>1&&r.React.createElement("option",{value:"All"},this.props.intl.formatMessage({id:"all",defaultMessage:a.defaultMessages.all}))))},t}(r.React.PureComponent);t.default=d},425:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(69),l=n(314),c=n(315),d=n(316),p=n(193),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onLabelChange=function(e){n.setState({newLabel:e.target.value})},n.onMoreIconClick=function(e){n.stopPropagation(e),n.props.onMoreIconClick&&n.props.onMoreIconClick(n.props.dataSourceJson)},n.onCloseIconClick=function(e){n.stopPropagation(e),n.props.onCloseIconClick&&n.props.onCloseIconClick(n.props.dataSourceJson)},n.onRename=function(){var e=n.state.newLabel.trim();n.props.onRename&&n.props.onRename(e)},n.onDataSourceItemClick=function(e){n.stopPropagation(e),n.props.onDataSourceItemClick&&n.props.onDataSourceItemClick(n.props.dataSourceJson)},n.onMappingIconClick=function(e){n.stopPropagation(e),n.props.onMappingIconClick&&n.props.onMappingIconClick(n.props.dataSourceJson)},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.getWhetherIsSetDs=function(e){if(!e)return!1;var t=r.DataSourceManager.getInstance().getDataSource(e.id);return!!t&&t.isDataSourceSet},n.getChildDssLength=function(e){if(!e)return null;var t=r.DataSourceManager.getInstance().getDataSource(e.id);return t&&t.isDataSourceSet?t.getChildDataSources().length:null},n.state={newLabel:n.props.dataSourceJson?n.props.dataSourceJson.label||n.props.dataSourceJson.id:""},n}return o(t,e),t.prototype.componentDidUpdate=function(e,t){e.isRenameInputShown!==this.props.isRenameInputShown&&this.props.isRenameInputShown&&this.renameInput&&(this.renameInput.focus(),this.renameInput.select()),e.dataSourceJson!==this.props.dataSourceJson&&this.setState({newLabel:this.props.dataSourceJson?this.props.dataSourceJson.label||this.props.dataSourceJson.id:""})},t.prototype.render=function(){var e,t=this;if(!this.props.dataSourceJson)return null;var n,s=i.getDsUsedWidgets(this.props.dataSourceJson.id,this.props.widgets),o=this.props.dataSourceJson.itemId&&this.props.portalUrl?this.props.portalUrl.replace(/\/$/,"")+"/home/item.html?id="+this.props.dataSourceJson.itemId:null,u=this.getWhetherIsSetDs(this.props.dataSourceJson);return u&&(n=this.getChildDssLength(this.props.dataSourceJson)),r.jsx("div",{className:r.classNames((e={},e[this.props.className]=!!this.props.className,e))},r.jsx("div",{className:r.classNames("component-data-source-item",{"component-data-source-item-selected-item":this.props.isSelected,"cursor-pointer":!!this.props.onDataSourceItemClick}),onClick:this.onDataSourceItemClick},r.jsx("div",{className:"d-flex justify-content-between align-items-center ds-item-header"},r.jsx("div",{className:"d-flex align-items-center w-100"},r.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},r.jsx(a.Icon,{icon:i.getDsIcon(this.props.dataSourceJson),className:"text-dark",size:"12"})),r.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},r.jsx("div",{className:"text-truncate ds-type-name"},i.getDsTypeString(this.props.dataSourceJson.type,this.props.intl)))),this.props.isMoreIconShown?r.jsx(a.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-1 flex-shrink-0 ds-more p-2",onClick:this.onMoreIconClick},r.jsx("span",{className:"ds-more-icon d-flex justify-content-center",title:this.props.intl.formatMessage({id:"more",defaultMessage:a.defaultMessages.more})},r.jsx(a.Icon,{icon:l,className:"align-baseline",size:"12"}))):null),r.jsx("div",{className:"ds-item-body"},this.props.isRenameInputShown?r.jsx(a.TextInput,{className:"m-2 flex-grow-1 text-truncate p-1 ds-label ds-label-input",ref:function(e){return t.renameInput=e},onBlur:this.onRename,onKeyUp:this.onRename,onChange:this.onLabelChange,value:this.state.newLabel,onClick:this.stopPropagation}):r.jsx("div",{className:"flex-grow-1 two-line-truncate ds-label text-left",title:this.props.dataSourceJson.label||this.props.dataSourceJson.id},this.props.dataSourceJson.label||this.props.dataSourceJson.id),r.jsx("div",{className:r.classNames("d-flex justify-content-between",{"mt-3":this.props.isOriginalUrlShown||this.props.isMappingIconShown})},r.jsx("div",{className:"d-flex"},u?r.jsx("div",{className:"mr-5 ds-child-dss font-dark-600"},r.jsx("span",{title:n+" "+this.props.intl.formatMessage({id:"layers",defaultMessage:a.defaultMessages.layers})},r.jsx(a.Icon,{icon:d,size:12,className:"mr-1"}),r.jsx("span",{className:"align-middle"},n))):null,this.props.isRelatedWidgetsShown?r.jsx("div",{className:"flex-grow-1 text-truncate flex-row ds-related-widgets font-dark-600"},r.jsx("span",{title:(s&&s.length)+" "+this.props.intl.formatMessage({id:"widgets",defaultMessage:a.defaultMessages.widgets})},r.jsx(a.Icon,{icon:p,size:12,className:"mr-1"}),r.jsx("span",{className:"align-middle"},s&&s.length))):null),this.props.isOriginalUrlShown&&o?r.jsx(a.Button,{size:"sm",icon:!0,type:"tertiary",className:"ds-origin-label",href:o,target:"_blank",onClick:this.stopPropagation},r.jsx(a.Icon,{icon:c,className:"m-0",size:12})):null))))},t}(r.React.PureComponent);t.DataSourceItem=r.ReactRedux.connect((function(e,t){var n=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.portalUrl:e.portalUrl;if(t.isRelatedWidgetsShown){var s=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.appConfig:e.appConfig;return{widgets:s&&s.widgets,portalUrl:n}}return{portalUrl:n}}))(r.injectIntl(r.themeUtils.withStyles(u,"DataSourceItem")))},68:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M4.103 7.873L16 19.25 27.897 7.873c.939-.898 2.46-.898 3.399 0s.939 2.353 0 3.251L17.7 24.127a2.481 2.481 0 01-3.399 0L.705 11.124c-.939-.898-.939-2.353 0-3.251s2.46-.898 3.399 0z"></path></svg>'},687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(688);n(0).ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/data-source-selector/",{componentStyles:s}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(695))},688:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(689);t.DataSourceSelector=s.dataSourceSelectorStyles;var o=n(690);t.DataSourceList=o.dataSourceListStyles;var r=n(691);t.ExternalDataSourceSelector=r.externalDataSourceSelectorStyles;var a=n(692);t.DataSourceItem=a.dataSourceItemStyles;var i=n(693);t.DataSourceErrorItem=i.dataSourceErrorItemStyles;var l=n(694);t.FieldSelector=l.fieldSelectorStyles},689:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.dataSourceSelectorStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        padding: ",";\n        margin-top: ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .icon-left{\n          margin-left: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "],["\n    .component-data-source-selector{\n      .font-dark-600{\n        color: ",";\n      }\n      .ds-selector-button{\n        height: ",";\n        line-height: ",";\n        padding: 0;\n        border: 1px dashed ",";\n        border-radius: ",";\n        cursor: pointer;\n        color: ",";\n        font-size: ",";\n        text-decoration: none;\n        &:hover{\n          border-color: ",";\n          color: ",";\n        }\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        padding: ",";\n        margin-top: ",";\n        background-color: ",";\n        cursor: pointer;\n\n        .mr-30{\n          margin-right: ",";\n        }\n\n        &.disable-cursor{\n          cursor: default;\n        }\n\n        .ds-item-close{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n          margin-right: -5px;\n        }\n\n        .icon-left{\n          margin-left: -5px;\n        }\n\n        .ds-item-filter{\n          height: 100%;\n          cursor: pointer;\n        }\n\n        .ds-item-sort{\n          height: 100%;\n          cursor: pointer;\n          margin-left: ",";\n        }\n\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .top-right-red-dot-container{\n          position: relative;\n        }\n        .top-right-red-dot{\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: inline-block;\n          width: 8px;\n          height: 8px;\n          border-radius: 4px;\n          background-color: ",";\n        }\n      }\n    }\n\n  "])),t.colors.palette.dark[600],r.polished.rem(40),r.polished.rem(40),t.colors.palette.dark[100],r.polished.rem(2),t.colors.palette.primary[700],r.polished.rem(14),t.colors.palette.dark[400],t.colors.palette.primary[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],r.polished.rem(10),r.polished.rem(8),t.colors.palette.secondary[500],r.polished.rem(30),r.polished.rem(5),r.polished.rem(5),r.polished.rem(18),r.polished.rem(18),t.colors.palette.info[400],r.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.danger[700])}},69:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=n(0),r=n(3),a=n(116);function i(e,t){return e&&t?function(e){if(!e)return[];var t=[];return Object.keys(e).forEach((function(n){t.push(e[n])})),t}(t).filter((function(t){return t&&!1!==t.useDataSourcesEnabled&&t.useDataSources&&t.useDataSources.some((function(t){return t.dataSourceId===e}))})).map((function(e){return e.id})):[]}function l(e){if(!e||!e.id)return[];var t=c(),n=t&&t.dataSources,s=[];return n&&Object.keys(n).forEach((function(t){n[t]&&n[t].isOutputFromWidget&&n[t].originDataSources&&n[t].originDataSources.some((function(t){return t.dataSourceId===e.id}))&&(s=s.concat(d().getDataSource(t)))})),s}function c(){var e=window&&window.jimuConfig&&window.jimuConfig.isBuilder?o.getAppStore().getState().appStateInBuilder:o.getAppStore().getState();return e&&e.appConfig}function d(){return o.DataSourceManager.getInstance()}!function(e){e.Point="POINT",e.Polyline="POLYLINE",e.Polygon="POLYGON"}(s=t.GeoType||(t.GeoType={})),t.getDsUsedWidgets=function(e,t){if(!e||!t)return[];var n=i(e,t),s=function(e,t){if(!e||!t)return[];var n=l(d().getDataSource(e)),s=[],o=[];return n.forEach((function(e){e&&e.id&&(o=i(e.id,t),s=s.concat(o))})),Array.from(new Set(s))}(e,t);return Array.from(new Set(n.concat(s))).map((function(e){return t[e]}))},t.isFuzzySearch=function(e,t){return!(!e||!e.label)&&(!t||e.label.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1)},t.isFuzzyFromDsIds=function(e,t){return!(!e||!e.id)&&(!t||t.indexOf(e.id)>-1)},t.getOutputDssFromOriginDs=l,t.getAppConfig=c,t.getDsIcon=function(e){switch(function(e,t){switch(e){case a.AllDataSourceTypes.WebMap:case a.AllDataSourceTypes.FeatureSet:case a.AllDataSourceTypes.WebScene:return e;case a.AllDataSourceTypes.FeatureLayer:case a.AllDataSourceTypes.FeatureQuery:return t?e+"_"+t:e;default:return"UNKNOWN"}}(e&&e.type,function(e){if(e){if(-1!==e.toLocaleLowerCase().indexOf(s.Point.toLocaleLowerCase()))return s.Point;if(-1!==e.toLocaleLowerCase().indexOf(s.Polyline.toLocaleLowerCase()))return s.Polyline;if(-1!==e.toLocaleLowerCase().indexOf(s.Polygon.toLocaleLowerCase()))return s.Polygon}return null}(e&&e.geometryType||function(e){var t=d(),n=e&&t.getDataSource(e.id),s=null;n&&n.type===a.AllDataSourceTypes.FeatureQuery?s=n.getLayerDefinition().geometryType:n&&n.type===a.AllDataSourceTypes.FeatureLayer&&(s=n.layer.geometryType);return s}(e)))){case a.AllDataSourceTypes.WebMap:return n(190);case a.AllDataSourceTypes.WebScene:return n(191);case a.AllDataSourceTypes.FeatureLayer+"_"+s.Point:case a.AllDataSourceTypes.FeatureQuery+"_"+s.Point:return n(301);case a.AllDataSourceTypes.FeatureLayer+"_"+s.Polyline:case a.AllDataSourceTypes.FeatureQuery+"_"+s.Polyline:return n(302);case a.AllDataSourceTypes.FeatureLayer+"_"+s.Polygon:case a.AllDataSourceTypes.FeatureQuery+"_"+s.Polygon:return n(303);case""+a.AllDataSourceTypes.FeatureLayer:case""+a.AllDataSourceTypes.FeatureQuery:return n(192);case""+a.AllDataSourceTypes.FeatureSet:return n(193);default:return n(304)}},t.getDsTypeString=function(e,t){if(!e||!t)return"";switch(e){case a.AllDataSourceTypes.FeatureLayer:case a.AllDataSourceTypes.FeatureQuery:return t.formatMessage({id:"featureLayer",defaultMessage:r.defaultMessages.featureLayer});case a.AllDataSourceTypes.FeatureSet:return t.formatMessage({id:"featureSet",defaultMessage:r.defaultMessages.featureSet});case a.AllDataSourceTypes.Map:return t.formatMessage({id:"map",defaultMessage:r.defaultMessages.map});case a.AllDataSourceTypes.SimpleLocal:return t.formatMessage({id:"simpleLocal",defaultMessage:r.defaultMessages.simpleLocal});case a.AllDataSourceTypes.WebMap:return t.formatMessage({id:"webMap",defaultMessage:r.defaultMessages.webMap});case a.AllDataSourceTypes.WebScene:return t.formatMessage({id:"webScene",defaultMessage:r.defaultMessages.webScene});case a.AllDataSourceTypes.CSV:return t.formatMessage({id:"csv",defaultMessage:r.defaultMessages.csv});default:return""}},t.getWhetherDataSourceIsInited=function(e){return!e||!Object.keys(e).some((function(t){return e[t].instanceStatus!==o.DataSourceStatus.Created&&e[t].instanceStatus!==o.DataSourceStatus.CreateError}))}},690:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.dataSourceListStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        text-indent: 22px;\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .collapse-label-icon{\n        color: ",";\n        svg{\n          color: ",";\n        }\n        .collapse-label{\n          width: ",";\n          font-size: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            padding: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 80px);\n      }\n\n      .ds-list{\n        height: calc(100% - 120px);\n        overflow: auto;\n        padding: 0 ",";\n      }\n\n      .ds-list-header{\n        width: 100%;\n        height: ",";\n        line-height: ",";\n        border-bottom: 0;\n        color: ",";\n        font-size: ",";\n        font-weight: 500;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-collapse-btn{\n        cursor: pointer;\n        .jimu-icon{\n          vertical-align: top;\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: ",";\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "],["\n    .component-data-source-list{\n      font-size: ",";\n      overflow: hidden;\n\n      .search{\n        position: relative;\n      }\n      .search-input{\n        height: 26px;\n        text-indent: 22px;\n        border-radius: 2px;\n      }\n      .search-icon{\n        color: ",";\n        position: absolute;\n        top: 6px;\n        left: 22px;\n      }\n\n      .empty-placeholder{\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        .empty-placeholder-text, .empty-placeholder-icon{\n          display: table;\n          margin: 0 auto;\n        }\n        .empty-placeholder-text{\n          color: ",";\n          font-size: ",";\n          margin-top: 16px;\n          text-align: center;\n        }\n        .empty-placeholder-icon{\n          color: ",";\n        }\n      }\n\n      .collapse-label-icon{\n        color: ",";\n        svg{\n          color: ",";\n        }\n        .collapse-label{\n          width: ",";\n          font-size: ",";\n        }\n      }\n\n      .jimu-tab{\n        height: 100%;\n        .tab-content{\n          height: calc(100% - 40px);\n        }\n        .tab-pane{\n          width: 100%;\n        }\n        .jimu-nav.nav-pills{\n            padding: 0 "," !important;\n          }\n      }\n\n      .ds-list-container{\n        height: calc(100% - 80px);\n      }\n\n      .ds-list{\n        height: calc(100% - 120px);\n        overflow: auto;\n        padding: 0 ",";\n      }\n\n      .ds-list-header{\n        width: 100%;\n        height: ",";\n        line-height: ",";\n        border-bottom: 0;\n        color: ",";\n        font-size: ",";\n        font-weight: 500;\n      }\n\n      .ds-add-data{\n        position: absolute;\n        bottom: 0;\n        height: ",";\n        width: 100%;\n        color: ",";\n        font-size: ",";\n        border-top: 1px solid ",";\n        cursor: pointer;\n        &:hover{\n          .add-data-icon-container{\n            background-color: ",";\n          }\n          color: ",";\n        }\n        .add-data-icon-container{\n          width: ",";\n          height: ",";\n          background-color: ",";\n          border-radius: ",";\n        }\n        .add-data-icon{\n          color: ",";\n        }\n      }\n\n      .ds-list-close{\n        width: ",";\n        height: 100%;\n        cursor: pointer;\n      }\n\n      .ds-widget-back{\n        width: ",";\n        height: ",";\n        cursor: pointer;\n      }\n\n      .ds-types{\n        color: ",";\n        font-size: ",";\n        margin: "," 0;\n        padding: 0 ",";\n      }\n\n      .ds-widget-outputs{\n        padding: 0;\n      }\n\n      .ds-added-data{\n        padding: 0;\n      }\n\n      .to-use-types{\n        color: ",";\n        .types-selected{\n          max-width: ",";\n        }\n        .to-use-dp{\n          width: ",";\n          height: ",";\n        }\n      }\n\n      .ds-collapse-btn{\n        cursor: pointer;\n        .jimu-icon{\n          vertical-align: top;\n        }\n      }\n\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-item.ds-error-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n      .ds-item{\n        border: 2px solid transparent;\n        position: relative;\n        cursor: pointer;\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: ",";\n          padding-right: ",";\n        }\n        .selected{\n          width:  ",";\n          height:  ",";\n          border-radius: 0 0 0 2px;\n          background-color: ",";\n          position: absolute;\n          top: 0;\n          right: 0;\n          .selected-icon{\n            color: ",";\n            margin-left: 2px;\n            margin-top: -2px;\n          }\n        }\n      }\n      .ds-item.ds-item-selected{\n        border: 2px solid ",";\n      }\n    }\n\n  "])),t.typography.fontSizeBase,t.colors.palette.dark[600],t.colors.palette.dark[400],r.polished.rem(14),t.colors.palette.secondary[800],t.colors.palette.dark[600],t.colors.palette.dark[600],r.polished.rem(160),r.polished.rem(14),r.polished.rem(16),r.polished.rem(16),r.polished.rem(66),r.polished.rem(66),t.colors.palette.dark[600],r.polished.rem(16),r.polished.rem(40),t.colors.palette.primary[700],r.polished.rem(14),t.colors.palette.secondary[800],t.colors.palette.primary[800],t.colors.palette.primary[800],r.polished.rem(20),r.polished.rem(20),t.colors.palette.primary[700],r.polished.rem(10),t.colors.palette.light[300],r.polished.rem(30),r.polished.rem(80),r.polished.rem(30),t.colors.black,t.typography.fontSizeBase,r.polished.rem(6),r.polished.rem(16),t.colors.black,r.polished.rem(150),r.polished.rem(120),r.polished.rem(26),r.polished.rem(18),r.polished.rem(18),t.colors.palette.info[400],r.polished.rem(14),t.colors.palette.dark[800],t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.secondary[800],r.polished.rem(52),t.colors.palette.secondary[500],r.polished.rem(10),r.polished.rem(10),r.polished.rem(24),r.polished.rem(24),t.colors.palette.primary[700],t.colors.palette.secondary[500],t.colors.palette.primary[700])}},691:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.externalDataSourceSelectorStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: ",";\n          padding-right: ",";\n        }\n        .remove{\n          position: absolute;\n          top: 0;\n          right: 0;\n          padding: 2px;\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        width: ",";\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        width: calc(100% - ",");\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          padding: "," ",";\n          height: calc(100% - 70px);\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            margin-right: ",";\n          }\n        }\n        .item-selector-search{\n          height: ",";\n          line-height: ",";\n          position: relative;\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            height: 100%;\n            .jimu-icon{\n              color: ",";\n              margin: 0;\n            }\n          }\n\n          .search-input{\n            width: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            text-indent: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "],["\n    .component-external-data-source-selector{\n      height: 100%;\n      overflow: hidden;\n      position: relative;\n\n      .inner-item-selector-container{\n        .item-selector-container{\n          height: calc(100% - 110px);\n        }\n      }\n\n      .added-ds-item{\n        position: relative;\n        cursor: pointer;\n        .ds-thumbnail{\n          width:  ",";\n          height:  ",";\n          background-color: ",";\n        }\n        .ds-type{\n          font-size: ",";\n          color: ",";\n        }\n        .item{\n          height: ",";\n          background-color: ",";\n          padding-left: ",";\n          padding-right: ",";\n        }\n        .remove{\n          position: absolute;\n          top: 0;\n          right: 0;\n          padding: 2px;\n        }\n      }\n\n      .added-ds-container{\n        width: ",";\n        background-color: ",";\n        box-shadow: 0 0 10px 4px ",";\n        position: absolute;\n        right: 30px;\n        bottom: 30px;\n        .added-ds-items{\n          max-height: ",";\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        .small-done-btn{\n          max-width: ",";\n        }\n      }\n\n      .mt-30{\n        margin-top: ",";\n        margin-bottom: ",";\n      }\n\n      .selector-left{\n        width: ",";\n        background-color: ",";\n        border-right: 1px solid ",";\n        .selector-left-title{\n          padding: "," "," "," ",";\n          margin: 0;\n          font-size: ",";\n          color: ",";\n        }\n        .nav.nav-underline{\n          border: 0;\n          .nav-item{\n            .nav-link{\n              padding: 0;\n              border: 0;\n              .jimu-nav-link-wrapper{\n                display: flex;\n                justify-content: flex-start;\n                align-items: center;\n                padding: "," ",";\n                font-size: ",";\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item:hover{\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n              }\n            }\n          }\n\n          .nav-item.active-tab{\n            background-color: ",";\n            border-left: 4px solid ",";\n            .nav-link{\n              .jimu-nav-link-wrapper{\n                color: ",";\n                font-weight: 500;\n                padding-left: ",";\n              }\n            }\n          }\n        }\n      }\n\n      .selector-right{\n        width: calc(100% - ",");\n        .selector-right-header{\n          padding: "," "," "," ",";\n        }\n        .selector-right-body{\n          padding: "," ",";\n          height: calc(100% - 70px);\n        }\n        .nav-item{\n          .nav-link{\n            .jimu-nav-link-wrapper{\n              font-size: ",";\n            }\n          }\n        }\n        .nav-item.active-tab{\n          .nav-link{\n            border-bottom: 3px solid ",";\n            padding: 0;\n            .jimu-nav-link-wrapper{\n              color: ",";\n              font-weight: 500;\n            }\n          }\n        }\n      }\n\n      .external-data-source-url-input{\n        .url-type-select{\n          width: ",";\n        }\n        .url-input{\n          width: ",";\n        }\n        .url-input-add-btn{\n          height: ",";\n        }\n        .url-input-label{\n          font-size: ",";\n          color: ",";\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n      }\n\n      .external-data-source-app-data{\n        .item-list{\n          display: flex;\n          flex-wrap: wrap;\n          margin-top: 2rem;\n          margin-left: -0.5rem;\n          margin-right: -0.5rem;\n          overflow-x: hidden;\n          overflow-y: auto;\n\n          .item{\n            width: ","%;\n            margin-bottom: 1rem;\n            padding: 0 0.5rem;\n\n            .item-active-border-transparent{\n              border: "," solid transparent;\n\n              &:hover{\n                border-color: ",";\n              }\n            }\n\n            .item-card-container.item-border-transparent{\n              border: "," solid transparent;\n            }\n\n            .item-card-container{\n              border: "," solid;\n              padding-bottom: ",";\n              position: relative;\n              overflow: hidden;\n\n              &:hover{\n                border-color: transparent !important;\n              }\n\n              .item-card{\n                position: absolute;\n\n                .item-card-content{\n                  padding: ",";\n                }\n\n                .item-label{\n                  max-height: ",";\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                  white-space: nowrap;\n                }\n\n                .item-logo{\n                  width: ",";\n                  height: ",";\n                }\n\n                .item-active-icon{\n                  position: absolute;\n                  top: ",";\n                  left: ",";\n\n                  .item-active-icon-container{\n                    width: ",";\n                    height: ",";\n                    line-height: ",";\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      .external-data-source-item-selector{\n        .nav.nav-underline{\n          border: 0;\n          .nav-item:not(:last-child){\n            margin-right: ",";\n          }\n        }\n        .item-selector-search{\n          height: ",";\n          line-height: ",";\n          position: relative;\n\n          .search-icon{\n            position: absolute;\n            left: ",";\n            padding: 0;\n            padding: 0;\n            height: 100%;\n            .jimu-icon{\n              color: ",";\n              margin: 0;\n            }\n          }\n\n          .search-input{\n            width: ",";\n            background-color: ",";\n            color: ",";\n            font-size: ",";\n            text-indent: ",";\n            border-radius: 2px;\n          }\n          .search-input::-ms-clear{\n            display: none;\n          }\n        }\n\n        .item-selector-sort{\n          margin-right: -",";\n          .item-selector-sort-by{\n            color: ",";\n            font-size: ",";\n            height: ",";\n            .item-selector-sort-select{\n              width: ",";\n              padding: 2px 6px;\n              font-size: ",";\n              height: ",";\n            }\n          }\n        }\n      }\n\n    }\n\n  "])),r.polished.rem(18),r.polished.rem(18),t.colors.palette.info[400],r.polished.rem(14),t.colors.palette.dark[800],r.polished.rem(52),t.colors.palette.secondary[500],r.polished.rem(10),r.polished.rem(10),r.polished.rem(300),t.colors.palette.light[600],r.polished.rgba(t.colors.white,.3),r.polished.rem(500),r.polished.rem(100),r.polished.rem(30),r.polished.rem(20),r.polished.rem(260),t.colors.palette.light[400],t.colors.palette.light[800],r.polished.rem(20),r.polished.rem(20),r.polished.rem(27),r.polished.rem(20),r.polished.rem(20),t.colors.palette.dark[600],r.polished.rem(7),r.polished.rem(20),r.polished.rem(16),t.colors.palette.dark[600],t.colors.black,t.colors.palette.light[500],t.colors.palette.primary[600],t.colors.black,r.polished.rem(16),r.polished.rem(260),r.polished.rem(23),r.polished.rem(20),r.polished.rem(12),r.polished.rem(20),r.polished.rem(10),r.polished.rem(65),r.polished.rem(16),t.colors.palette.primary[600],t.colors.black,r.polished.rem(200),r.polished.rem(500),r.polished.rem(30),r.polished.rem(13),t.colors.palette.dark[600],20,r.polished.rem(2),t.colors.primary,r.polished.rem(2),r.polished.rem(1),r.polished.rem(135),r.polished.rem(5),r.polished.rem(60),r.polished.rem(60),r.polished.rem(60),r.polished.rem(5),r.polished.rem(5),r.polished.rem(20),r.polished.rem(20),r.polished.rem(20),r.polished.rem(40),r.polished.rem(32),r.polished.rem(32),r.polished.rem(6),t.colors.palette.dark[400],r.polished.rem(200),t.colors.palette.secondary[200],t.colors.palette.dark[400],r.polished.rem(14),r.polished.rem(25),r.polished.rem(16),t.colors.palette.dark[400],r.polished.rem(13),r.polished.rem(32),r.polished.rem(140),r.polished.rem(13),r.polished.rem(26))}},692:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.dataSourceItemStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "],["\n    .component-data-source-item{\n      background-color: ",";\n      font-size: ",";\n      border-radius: 2px;\n      padding: 0;\n      .font-dark-600{\n        color: "," !important;\n      }\n      .ds-item-header{\n        width: 100%;\n        height: ",";\n        padding: 0 10px;\n        background-color: ",";\n      }\n      .ds-item-body{\n        width: 100%;\n        height: 100%;\n        padding: 14px 10px 6px 10px;\n      }\n      .two-line-truncate{\n        overflow: hidden;\n        text-overflow: ellipsis;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        word-break: break-word;\n        word-wrap: break-word;\n      }\n      .ds-more{\n        margin-right: ",";\n      }\n      .ds-label{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-type{\n        font-size: ",";\n        color: ",";\n      }\n      .ds-thumbnail{\n        width:  ",";\n        height:  ",";\n        background-color: ",";\n      }\n      .ds-related-widgets, .ds-child-dss{\n        font-size: ",";\n      }\n    }\n\n    .component-data-source-item.component-data-source-item-selected-item{\n      border: "," solid ",";\n    }\n\n    .cursor-pointer{\n      cursor: pointer;\n    }\n\n  "])),t.colors.palette.secondary[500],r.polished.rem(12),t.colors.palette.dark[600],r.polished.rem(38),t.colors.palette.secondary[700],r.polished.rem(-8),r.polished.rem(14),t.colors.palette.dark[800],r.polished.rem(11),t.colors.palette.dark[800],r.polished.rem(18),r.polished.rem(18),t.colors.palette.info[400],r.polished.rem(13),r.polished.rem(2),t.colors.primary)}},693:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.dataSourceErrorItemStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "],["\n    .component-data-source-error-item{\n      .component-data-source-item{\n        background-color: ",";\n        *{\n          color: "," !important;\n        }\n\n        .ds-origin-label{\n          max-width: 100%;\n          .ds-origin-label-link, .ds-origin-label-link:hover, .ds-origin-label-link:focus, .ds-origin-label-link:active{\n            color: ",";\n          }\n        }\n        .ds-item-header{\n          background-color: ",";\n        }\n        .ds-thumbnail{\n          background-color: ",";\n        }\n      }\n\n    }\n\n  "])),t.colors.palette.secondary[400],t.colors.palette.dark[400],t.colors.palette.dark[400],t.colors.palette.secondary[500],t.colors.palette.secondary[800])}},694:function(e,t,n){"use strict";var s=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0);t.fieldSelectorStyles=function(e){var t=e.theme;return r.css(o||(o=s(["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n        .ds-name-selected{\n          max-width: ",";\n        }\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 120px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 1px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        text-indent: ",";\n      }\n\n    }\n\n  "],["\n    .component-field-selector{\n      font-size: ",";\n      .ds-name{\n        color: ",";\n        .ds-name-selected{\n          max-width: ",";\n        }\n      }\n      .ds-name-label{\n        font-size: ",";\n        color: ",";\n        font-weight: 400;\n      }\n      .field-data-selected{\n        width: 70%;\n      }\n\n      .item-selector-search{\n        height: ",";\n        position: relative;\n      }\n\n      .field-list{\n        height: calc(100% - 120px);\n        overflow-y: auto;\n        .field-item.field-item-selected{\n          border: 1px solid ",";\n        }\n        .field-item{\n          border: 1px solid transparent;\n          cursor: pointer;\n          background-color: ",";\n          user-select: none;\n        }\n        .field-item:hover{\n          background-color: ",";\n        }\n        .field-item:active.field-item:hover{\n          background-color: ",";\n        }\n      }\n\n      .search-icon{\n        position: absolute;\n        top: ",";\n        left: ",";\n      }\n\n      .search-input{\n        height: ",";\n        text-indent: ",";\n      }\n\n    }\n\n  "])),t.typography.fontSizeBase,t.colors.black,r.polished.rem(150),r.polished.rem(14),t.colors.palette.dark[400],r.polished.rem(26),t.colors.primary,t.colors.palette.light[400],t.colors.palette.light[500],t.colors.white,r.polished.rem(5),r.polished.rem(25),r.polished.rem(26),r.polished.rem(25))}},695:function(e,t,n){"use strict";function s(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(116);t.AllDataSourceTypes=o.AllDataSourceTypes;var r=n(69);t.dataComponentsUtils=r,s(n(696)),s(n(418)),s(n(419)),s(n(425)),s(n(707)),s(n(708))},696:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(n[s[o]]=e[s[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),l=n(3),c=n(697),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleUseDataEnabled=function(){n.props.onToggleUseDataEnabled&&n.props.onToggleUseDataEnabled(!n.props.useDataSourcesEnabled)},n.onSelect=function(e,t){n.props.onSelect&&n.props.onSelect(e,t)},n.onRemove=function(e,t){n.props.onRemove&&n.props.onRemove(e,t)},n}return o(t,e),t.prototype.render=function(){var e,t=this.props,n=(t.onSelect,t.onRemove,a(t,["onSelect","onRemove"]));return i.jsx("div",{className:i.classNames("w-100",(e={},e[this.props.className]=!!this.props.className,e))},i.jsx("div",{className:"component-data-source-selector"},!this.props.mustUseDataSource&&i.jsx("div",{className:i.classNames("d-flex justify-content-between w-100 align-items-center",{"mb-3":this.props.useDataSourcesEnabled})},i.jsx("label",{className:"w-75 text-truncate d-inline-block font-dark-600"},this.props.intl.formatMessage({id:"connectToData",defaultMessage:l.defaultMessages.connectToData})),i.jsx(l.Switch,{checked:this.props.useDataSourcesEnabled,onChange:this.onToggleUseDataEnabled})),(this.props.mustUseDataSource||this.props.useDataSourcesEnabled)&&i.jsx(c.default,r({types:this.props.types},n,{onSelect:this.onSelect,onRemove:this.onRemove,intl:this.props.intl,closeDataSourceListOnSelect:this.props.closeDataSourceListOnSelect,fromDsIds:this.props.fromDsIds}))))},t}(i.React.PureComponent),p=i.injectIntl(i.themeUtils.withStyles(d,"DataSourceSelector"));t.DataSourceSelector=i.ReactRedux.connect((function(e){return{dataSources:e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources,dataSourcesInfo:e.appStateInBuilder&&e.appStateInBuilder.dataSourcesInfo}}))(p)},697:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(69),l=n(418),c=n(706),d=n(35),p=function(e){function t(t){var n=e.call(this,t)||this;return n.dsManager=r.DataSourceManager.getInstance(),n.__unmount=!1,n.showSqlExprPopup=function(){n.setState({isSqlExprShow:!0})},n.toggleSqlExprPopup=function(){n.setState({isSqlExprShow:!n.state.isSqlExprShow})},n.onSqlExprBuilderChange=function(e){var t=n.props.onFilterChange;if(t){var s=n.state.currentDsId;t(e.asMutable({deep:!0}),s)}},n.onSortChange=function(e,t){var s=n.props.onSortChange;s&&s(e,n.state.currentDsId)},n.onClickFilter=function(e){e&&n.setState({currentDsId:e,isSqlExprShow:!0})},n.onClickSort=function(e){e&&n.setState({currentDsId:e,modalType:"sort"})},n.changeInitStatus=function(e){n.setState({isDataSourceInited:e})},n.disableSelection=function(){if(n.props.disableSelection){var e=n.getDssWithRootId(n.props.selectedDataSourceIds.asMutable());return n.props.disableSelection(e)}return!1},n.disableRemove=function(){if(n.props.disableRemove){var e=n.getDssWithRootId(n.props.selectedDataSourceIds.asMutable());return n.props.disableRemove(e)}return!1},n.getDsByDsId=function(e){return n.dsManager.getDataSource(e)},n.getDssWithRootId=function(e){if(!e)return null;var t=[];return e&&e.filter((function(e){return!!e})).forEach((function(e){var s=n.dsManager.getDataSource(e);if(s)t.push(s);else{var o=r.getAppStore()&&r.getAppStore().getState(),a=o&&o.appStateInBuilder&&o.appStateInBuilder.appConfig&&o.appStateInBuilder.appConfig.dataSources,i=a&&a[e];t.push({dataSourceJson:i})}})),t.filter((function(e){return!!e&&!!e.dataSourceJson})).map((function(e){var t={dataSourceJson:e.dataSourceJson},n=e.getRootDataSource&&e.getRootDataSource();return n&&(t.rootDataSourceId=n.id),t}))},n.onModalClose=function(){n.setState({modalType:"none"})},n.onDsSelected=function(e){var t;e&&e.dataSourceJson&&(t=n.props.selectedDataSourceIds&&n.props.isMultiple?n.getDssWithRootId(n.props.selectedDataSourceIds.asMutable()).concat(e):[e],n.props.onSelect&&n.props.onSelect(t,e),n.props.closeDataSourceListOnSelect&&n.setState({modalType:"none"}))},n.onDsRemoved=function(e){if(e&&e.dataSourceJson&&n.props.selectedDataSourceIds){var t=n.getDssWithRootId(n.props.selectedDataSourceIds.filter((function(t){return t!==e.dataSourceJson.id})).asMutable());n.props.onRemove&&n.props.onRemove(t,e)}},n.toggleDsList=function(){n.props.disableDsList||n.setState({modalType:"ds"===n.state.modalType?"none":"ds"})},n.getSingleUsedDs=function(e){if(!e||!e.dataSourceJson)return null;var t={dataSourceId:e.dataSourceJson.id};return e.rootDataSourceId&&(t.rootDataSourceId=e.rootDataSourceId),t},n.getWhetherShowPlaceholder=function(){if(n.props.disableSelection){var e=n.getDssWithRootId(n.props.selectedDataSourceIds.asMutable());return!n.props.disableSelection(e)}return n.props.isMultiple||!n.props.isMultiple&&(!n.props.selectedDataSourceIds||0===n.props.selectedDataSourceIds.filter((function(e){return!!e})).length)},n.state={isDataSourceInited:i.getWhetherDataSourceIsInited(n.props.dataSourcesInfo),modalType:"none",isSqlExprShow:!1,currentDsId:void 0,SqlExpressionBuilder:null,SqlExpressionRuntime:null,SidePopper:null},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.__unmount=!1,Promise.all([r.moduleLoader.loadModule("jimu-ui/sql-expression-builder"),r.moduleLoader.loadModule("jimu-ui/sql-expression-runtime")]).then((function(t){var n=t[0],s=t[1];e.__unmount||e.setState({SqlExpressionBuilder:n,SqlExpressionRuntime:s})})),r.moduleLoader.loadModule("jimu-ui/setting-components").then((function(t){e.__unmount||e.setState({SidePopper:t.SidePopper})}))},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.componentDidUpdate=function(e){this.props.dataSources===e.dataSources&&this.props.dataSourcesInfo===e.dataSourcesInfo||this.changeInitStatus(i.getWhetherDataSourceIsInited(this.props.dataSourcesInfo))},t.prototype.render=function(){var e=this,t=this.props,n=t.filterEnabled,s=t.sortEnabled,o=t.sortConfig,i=t.filterConfig,p=t.theme,u=this.state,h=u.currentDsId,m=u.isSqlExprShow,f=u.modalType,g=h&&this.getDsByDsId(h),v=this.state.SqlExpressionBuilder&&this.state.SqlExpressionBuilder.Sort,S=this.state.SqlExpressionBuilder&&this.state.SqlExpressionBuilder.SqlExpressionBuilderPopup,y=this.state.SqlExpressionRuntime&&this.state.SqlExpressionRuntime.SqlExpressionMode,b={height:"51px",borderBottom:"0",fontSize:p.typography.sizes.lg},D=this.state.SidePopper,x=this.getWhetherShowPlaceholder();return r.jsx("div",{className:"w-100"},this.props.selectedDataSourceIds&&this.getDssWithRootId(this.props.selectedDataSourceIds.asMutable()).map((function(t,a){return t&&t.dataSourceJson&&t.dataSourceJson.id?r.jsx(c.default,{key:a,dsJsonWithRootId:t,onRemove:e.onDsRemoved,intl:e.props.intl,hideRemove:e.disableRemove(),theme:e.props.theme,showFilter:n,showSort:s,disableDsList:e.props.disableDsList,haveSetSort:!(!o||Object.keys(o).some((function(e){return!o[e]||0===o[e].length||o[e].some((function(e){return!e||!e.jimuFieldName}))}))),haveSetFilter:!(!i||Object.keys(i).some((function(e){return!i[e]||!i[e].parts||0===i[e].parts.length}))),onClickFilter:e.onClickFilter,onClickSort:e.onClickSort,onClick:e.toggleDsList,className:e.props.isMultiple&&"mb-3"}):null})),D&&r.jsx(D,{isOpen:"none"!==f&&!r.urlUtils.getAppIdPageIdFromUrl().pageId,position:"right"},r.jsx("div",{className:"bg-light-300 h-100 w-100"},"ds"===f?r.jsx(l.DataSourceList,{types:this.props.types,onSelect:this.onDsSelected,changeInitStatus:this.changeInitStatus,onCloseClick:this.onModalClose,isMultiple:this.props.isMultiple,onRemove:this.onDsRemoved,fromDsIds:this.props.fromDsIds,selectedDsIds:this.props.selectedDataSourceIds,isDataSourceInited:this.state.isDataSourceInited,disableSelection:this.disableSelection(),disableRemove:this.disableRemove(),fromRootDsIds:this.props.fromRootDsIds,hideHeader:this.props.hideHeader,hideTypeDropdown:this.props.hideTypeDropdown,hideAddData:this.props.hideAddData}):r.jsx("div",{className:"px-3"},r.jsx("div",{style:b,className:"d-flex w-100 align-items-center justify-content-between"},r.jsx("div",{className:"d-flex align-items-center w-100"},this.props.intl.formatMessage({id:"sort",defaultMessage:a.defaultMessages.sort})),r.jsx("div",{className:"flex-shrink-0 text-center px-2",onClick:this.onModalClose},r.jsx(a.Icon,{icon:d,size:"16",className:"text-dark"}))),v&&r.jsx(v,{onChange:this.onSortChange,value:o&&o[h]||r.Immutable([]),useDataSource:this.getSingleUsedDs(g)})))),n&&S&&r.jsx(S,{selectedDs:g,mode:y&&y.Simple,isOpen:m,toggle:this.toggleSqlExprPopup,config:i&&i[h],onChange:this.onSqlExprBuilderChange,theme:this.props.theme,id:"list-widget-sql-expression-builder-popup"}),x&&r.jsx(a.Link,{className:"ds-selector-button w-100 mt-0 d-flex justify-content-center align-items-center px-2",onClick:this.toggleDsList},r.jsx("div",{className:"text-truncate"},this.props.buttonLabel||this.props.intl.formatMessage({id:"setDataSource",defaultMessage:a.defaultMessages.setDataSource}))))},t}(r.React.PureComponent);t.default=r.themeUtils.withTheme(p)},698:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(699);t.HubDataSourceTypes=s.DataSourceTypes},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.HubAnnotations="HUB_ANNOTATIONS",e.HubEvents="HUB_EVENTS"}(t.DataSourceTypes||(t.DataSourceTypes={}))},700:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(421),l=function(e){function t(t){var n=e.call(this,t)||this;return n.dataSourceUrlTypes=[{label:n.props.intl.formatMessage({id:"featureLayer",defaultMessage:a.defaultMessages.featureLayer})}],n.onUrlTypesClicked=function(e){n.setState({selectedDataSourceUrlType:e.target.value})},n.onInputUrl=function(e){n.setState({url:e.target.value})},n.onAdded=function(){if(n.state.url){var e=n.state.url.replace(/^https?:/,"").split("?")[0];fetch(e+"?f=json").then((function(e){return e.json()})).then((function(e){var t,s=[];e&&e.layers&&Array.isArray(e.layers)?Promise.all(e.layers.map((function(e){return fetch(i.getDsJsonUrl(n.state.url,e,!0)+"?f=json").then((function(e){return e.json()}))}))).then((function(e){e.forEach((function(e){e&&e.type&&e.type===i.FEATURE_LAYER_TYPE&&(t=i.getSingleDsJsonFromLayer(n.state.url,n.props.getDsId(),e,!0))&&s.push(t)})),n.changeDsJsons(s)})):e&&e.type&&e.type===i.FEATURE_LAYER_TYPE&&((t=i.getSingleDsJsonFromLayer(n.state.url,n.props.getDsId(),e,!1))&&(s=[t]),n.changeDsJsons(s))}),(function(e){console.error(e),n.setState({isSupported:!1})}))}},n.changeDsJsons=function(e){e.length>0?(n.props.onAdded(e),n.setState({isSupported:!0})):n.setState({isSupported:!1})},n.state={selectedDataSourceUrlType:n.dataSourceUrlTypes[0],url:"",isSupported:!0},n}return o(t,e),t.prototype.componentDidMount=function(){},t.prototype.render=function(){return r.React.createElement("div",{className:"external-data-source-url-input"},r.React.createElement("div",{className:"mt-3 ml-2"},r.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"serviceType",defaultMessage:a.defaultMessages.serviceType})),r.React.createElement(a.Select,{value:this.state.selectedDataSourceUrlType.label,title:this.state.selectedDataSourceUrlType.label,onChange:this.onUrlTypesClicked,className:"url-type-select",buttonProps:{className:"text-truncate"},menuProps:{appendTo:"parent",zIndex:"3"}},this.dataSourceUrlTypes.map((function(e){return r.React.createElement("option",{key:e.label,value:e.label},e.label)})))),r.React.createElement("div",{className:"mt-4 ml-2"},r.React.createElement("h5",{className:"url-input-label"},this.props.intl.formatMessage({id:"url",defaultMessage:a.defaultMessages.url})),r.React.createElement(a.TextInput,{placeholder:"URL",onChange:this.onInputUrl,className:"url-input",value:this.state.url}),!this.state.isSupported&&r.React.createElement("p",{className:"mt-2"},this.props.intl.formatMessage({id:"unSupported",defaultMessage:a.defaultMessages.unSupported}))),r.React.createElement("div",{className:"mt-3 ml-2"},r.React.createElement(a.Button,{onClick:this.onAdded,type:"primary",disabled:!this.state.url,className:"url-input-add-btn px-3"},this.props.intl.formatMessage({id:"add",defaultMessage:a.defaultMessages.add}))))},t}(r.React.PureComponent);t.default=l},701:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(420),l=n(305),c=n(306),d=n(307),p=function(e){function t(t){var n,s,o=e.call(this,t)||this;return o.itemCategory=((n={})[i.ItemCategory.MyContent]=o.props.intl.formatMessage({id:"myContent",defaultMessage:a.defaultMessages.myContent}),n[i.ItemCategory.MyOrganization]=o.props.intl.formatMessage({id:"myOrganization",defaultMessage:a.defaultMessages.myOrganization}),n[i.ItemCategory.Public]=o.props.intl.formatMessage({id:"public",defaultMessage:a.defaultMessages.public}),n),o.sortField=((s={})[i.SortField.Modified]=o.props.intl.formatMessage({id:"modified",defaultMessage:a.defaultMessages.modified}),s[i.SortField.Title]=o.props.intl.formatMessage({id:"title",defaultMessage:a.defaultMessages.title}),s[i.SortField.Views]=o.props.intl.formatMessage({id:"numViews",defaultMessage:a.defaultMessages.numViews}),s),o.onCategoryChange=function(e){o.setState({activeCategory:e})},o.onSearchInputKeyDown=function(e){13===e.which?o.doSearch():o.setState({isSearchValueDone:!1})},o.doSearch=function(){o.searchValueWhenDone=o.state.searchValue,o.setState({isSearchValueDone:!0})},o.onSearchChange=function(e){o.setState({searchValue:e.target.value})},o.onSortFieldChange=function(e){var t=e.target.value;o.setState({selectedSortField:t})},o.onSortOrderChange=function(){o.setState({selectedSortOrder:o.state.selectedSortOrder===i.SortOrder.Desc?i.SortOrder.Asc:i.SortOrder.Desc})},o.onItemAdded=function(e,t){o.props.onSelect(e,t)},o.onItemRemoved=function(e,t){o.props.onRemove(e,t)},o.state={searchValue:"",selectedSortField:i.SortField.Modified,selectedSortOrder:i.SortOrder.Desc,isSearchValueDone:!1,activeCategory:i.ItemCategory.MyContent},o}return o(t,e),t.prototype.render=function(){var e=this;return r.React.createElement("div",{className:"external-data-source-item-selector w-100 h-100"},Object.keys(i.ItemCategory).map((function(t,n){return r.React.createElement("div",{className:r.classNames("h-100 w-100",{"d-none":i.ItemCategory[t]!==e.state.activeCategory}),key:n},r.React.createElement("div",{className:"w-100 d-flex justify-content-between align-items-end"},r.React.createElement(a.Nav,{underline:!0},Object.keys(i.ItemCategory).map((function(t){return r.React.createElement(a.NavItem,{key:t,title:e.itemCategory[i.ItemCategory[t]],className:r.classNames({"active-tab":e.state.activeCategory===i.ItemCategory[t]})},r.React.createElement(a.NavLink,{onClick:function(){e.onCategoryChange(i.ItemCategory[t])},active:e.state.activeCategory===i.ItemCategory[t],className:"w-100 text-truncate"},e.itemCategory[i.ItemCategory[t]]))}))),r.React.createElement("div",{className:"d-flex item-selector-search"},r.React.createElement(a.Button,{type:"tertiary",className:"search-icon",onClick:e.doSearch,icon:!0},r.React.createElement(a.Icon,{width:16,height:16,icon:l})),r.React.createElement(a.TextInput,{onKeyDown:e.onSearchInputKeyDown,placeholder:e.props.intl.formatMessage({id:"search",defaultMessage:r.defaultMessages.search}),onChange:e.onSearchChange,className:"search-input",value:e.state.searchValue}))),r.React.createElement("div",{className:"d-flex justify-content-end mt-30 mb-20"},r.React.createElement("div",{className:"d-flex justify-content-between align-items-center item-selector-sort"},r.React.createElement("div",{className:"item-selector-sort-by"},r.React.createElement("div",{className:"d-inline-block mr-2"},e.props.intl.formatMessage({id:"sort",defaultMessage:a.defaultMessages.sort})),r.React.createElement(a.Select,{value:e.state.selectedSortField,title:e.sortField[i.SortField[e.state.selectedSortField]],onChange:e.onSortFieldChange,className:"d-inline-block item-selector-sort-select",buttonProps:{className:"text-truncate"},menuProps:{appendTo:"parent",zIndex:"3"}},Object.keys(i.SortField).map((function(t){return r.React.createElement("option",{key:i.SortField[t],value:i.SortField[t]},e.sortField[i.SortField[t]])})))),r.React.createElement("div",{className:"item-selector-sort-order"},e.state.selectedSortOrder===i.SortOrder.Desc?r.React.createElement(a.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"decending",defaultMessage:a.defaultMessages.decending})},r.React.createElement(a.Icon,{width:16,height:16,icon:c})):r.React.createElement(a.Button,{type:"tertiary",onClick:e.onSortOrderChange,title:e.props.intl.formatMessage({id:"ascending",defaultMessage:a.defaultMessages.ascending})},r.React.createElement(a.Icon,{width:16,height:16,icon:d}))))),r.React.createElement("div",{className:"w-100 item-selector-container"},r.React.createElement(i.ItemSelector,{category:i.ItemCategory[t],portalUrl:e.props.portalUrl,searchValue:e.state.isSearchValueDone?e.state.searchValue:e.searchValueWhenDone,itemType:e.props.itemType,getDetailPosition:e.props.getItemDetailPosition,selectedItems:e.props.selectedItems,selectedSortField:e.state.selectedSortField,onSelect:e.onItemAdded,onRemove:e.onItemRemoved,isRadio:e.props.isRadio,partSelectedItems:e.props.partSelectedItems,selectedSortOrder:e.state.selectedSortOrder})))})))},t}(r.React.PureComponent);t.default=p},702:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(422),l=n(424),c=n(147),d=n(69),p=n(194),u=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null),n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue),n.setDataSources()},n.setToUseDataSources=function(e,t,s,o){var r=n.getToUseRootDss(e,t,s,o);n.getToUseChildDss(e,t,s,o).then((function(e){var t=n.getToUseWidgets(r,e);n.__unmount||n.setState({toUseRootDss:r,toUseChildDss:e,toUseWidgets:t})}))},n.setDataSources=function(){var e=n.getToUseRootDss(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue);n.getToUseChildDss(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue).then((function(t){n.__unmount||n.setState({childDss:t,rootDss:e})}))},n.setSelectedType=function(e){e&&n.setState({selectedType:e[0]})},n.setHasErrorDss=function(e){return n.setState({hasErrorSelectedDss:e})},n.getRootDss=function(){var e=r.DataSourceManager.getInstance().getWidgetGeneratedDataSources();return Object.keys(e).forEach((function(t){e[t]=e[t].filter((function(e){return e&&e.id&&e.dataSourceJson}))})),e},n.getToUseWidgets=function(e,t){return r.appConfigUtils.getAllWidgets(r.getAppStore().getState().appStateInBuilder.appConfig).filter((function(s){return e[s.id]||n.getRootDss()[s.id]&&n.getRootDss()[s.id].some((function(e){return!!t[e.id]}))}))},n.getToUseRootDss=function(e,t,s,o){var r={};if(t)return r;var a=n.getRootDss();return Object.keys(a).forEach((function(t){var n=a[t].filter((function(t){return t&&t.dataSourceJson&&c.getWhetherUseDataSource(t.dataSourceJson,e)&&d.isFuzzySearch(t.dataSourceJson,o)&&d.isFuzzyFromDsIds(t.dataSourceJson,s)}));n&&n.length>0&&(r[t]||(r[t]=[]),r[t]=r[t].concat(n))})),Object.keys(r).forEach((function(e){0===r[e].length&&delete r[e]})),r},n.getToUseChildDss=function(e,t,s,o){var a=[];if(t)a=t.asMutable().map((function(e){return r.DataSourceManager.getInstance().getDataSource(e)}));else{var i=n.getRootDss();Object.keys(i).forEach((function(e){a=a.concat(i[e])}))}return c.getToUseChildDss(a,e).then((function(e){var t={};return Object.keys(e).forEach((function(n){e[n].some((function(e){return d.isFuzzySearch(e.dataSourceJson,o)&&d.isFuzzyFromDsIds(e.dataSourceJson,s)}))&&(t[n]=e[n].filter((function(e){return d.isFuzzySearch(e.dataSourceJson,o)&&d.isFuzzyFromDsIds(e.dataSourceJson,s)})))})),t}))},n.getToUseChildDssByWidgetId=function(e){var t={};return n.getRootDss()[e].forEach((function(e){t[e.id]||(t[e.id]=[]),t[e.id]=n.state.toUseChildDss[e.id]?t[e.id].concat(n.state.toUseChildDss[e.id]):t[e.id]})),Object.keys(t).forEach((function(e){0===t[e].length&&delete t[e]})),t},n.getToUseTypes=function(){if(!n.state.childDss&&!n.state.rootDss)return r.Immutable([]);var e=[];return n.state.rootDss&&Object.keys(n.state.rootDss).forEach((function(t){n.state.rootDss[t].forEach((function(t){t&&t.type&&(e=e.concat(t.type))}))})),n.state.childDss&&Object.keys(n.state.childDss).forEach((function(t){n.state.childDss[t].forEach((function(t){t&&t.type&&(e=e.concat(t.type))}))})),r.Immutable(Array.from(new Set(e)))},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()||!(!n.state.hasErrorSelectedDss||!n.props.selectedDsIds)},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&Object.keys(n.state.toUseRootDss).length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.getWidgetLabelById=function(e){var t=n.state.toUseWidgets&&n.state.toUseWidgets.find((function(t){return t.id===e}));return t&&t.label},n.state={toUseRootDss:null,toUseChildDss:null,rootDss:null,childDss:null,toUseWidgets:null,selectedType:null,hasErrorSelectedDss:!0},n}return o(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){this.props.isDataSourceInited&&(t.selectedType===this.state.selectedType&&e.fromRootDsIds===this.props.fromRootDsIds||(this.state.selectedType?this.setToUseDataSources(r.Immutable([this.state.selectedType]),this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue):this.setToUseDataSources(this.props.types,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue)),e.types===this.props.types&&!1!==e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData())},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t;if(!this.state.toUseChildDss||!this.state.toUseRootDss||!this.state.toUseWidgets)return null;var n=c.getOutputTypes(this.props.types);return r.React.createElement("div",{className:"ds-widget-outputs h-100 w-100"},n&&n.length>0?r.React.createElement("div",{className:"pt-3 h-100"},this.props.hideTypeDropdown?null:r.React.createElement("div",{className:"ds-types"},r.React.createElement(l.default,{toUseTypes:n,onTypeSelected:this.setSelectedType,selectedTypes:r.Immutable([this.state.selectedType]),intl:this.props.intl})),this.getWhetherShowList()?r.React.createElement(i.default,{groupedDss:this.state.toUseRootDss,selectedDsIds:this.props.selectedDsIds,onSelect:this.props.onSelect,onRemove:this.props.onRemove,showErrorDss:!0,disableSelection:this.props.disableSelection,disableRemove:this.props.disableRemove,intl:this.props.intl,changeHasErrorSelectedDss:this.setHasErrorDss,getGroupLabelById:this.getWidgetLabelById}):r.React.createElement("div",null,(null===(t=null===(e=r.getAppStore().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&r.React.createElement("div",{className:"empty-placeholder w-100"},r.React.createElement("div",{className:"empty-placeholder-icon"},r.React.createElement(a.Icon,{icon:p,width:80,height:71})),r.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noWidgetOutputCanBeUsed",defaultMessage:a.defaultMessages.noWidgetOutputCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:a.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:a.defaultMessages.noSelectedType}))},t}(r.React.PureComponent);t.default=u},703:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(69),l=n(38),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getWhetherSelected=function(){return t.props.selectedDsIds&&t.props.selectedDsIds.some((function(e){return e===t.props.dsId}))},t.getDsJsonWithRootId=function(){var e=r.getAppStore()&&r.getAppStore().getState(),n=e&&e.appStateInBuilder&&e.appStateInBuilder.appConfig&&e.appStateInBuilder.appConfig.dataSources;return{dataSourceJson:n&&n[t.props.dsId]||r.Immutable({id:t.props.dsId})}},t.onItemClick=function(){if(t.getWhetherSelected()){if(t.props.disableRemove)return;t.props.onRemove&&t.props.onRemove(t.getDsJsonWithRootId())}else{if(t.props.disableSelection)return;t.props.onSelect&&t.props.onSelect(t.getDsJsonWithRootId())}},t}return o(t,e),t.prototype.render=function(){if(!this.props.dsId)return null;var e=this.getWhetherSelected(),t=this.getDsJsonWithRootId().dataSourceJson;return r.React.createElement("div",{onClick:this.onItemClick,className:r.classNames("mb-3 ds-item ds-error-item",{"ds-item-selected":e})},r.React.createElement("div",{className:"d-flex align-items-center w-100 item"},r.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},r.React.createElement(a.Icon,{icon:i.getDsIcon(t),className:"text-dark",size:"12"})),r.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},r.React.createElement("div",{className:"text-truncate ds-type-name",title:this.props.dsId},this.props.dsId)),e&&r.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 selected"},r.React.createElement(a.Icon,{icon:l,className:"selected-icon",size:16}))))},t}(r.React.PureComponent);t.default=c},704:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(423),l=n(147),c=n(68),d=n(106),p=function(e){function t(t){var n=e.call(this,t)||this;return n.toggleChildDss=function(){n.setState({isChildDssOpen:!n.state.isChildDssOpen})},n.state={isChildDssOpen:!0},n}return o(t,e),t.prototype.render=function(){var e=this;return this.props.childDss&&0!==this.props.childDss.length?r.React.createElement("div",null,r.React.createElement("div",{className:"d-flex pl-2 pr-2 pb-1 justify-content-between align-items-center mb-3"},r.React.createElement("div",{className:"d-flex align-content-center collapse-label-icon"},this.props.icon?r.React.createElement(a.Icon,{icon:this.props.icon,className:"mr-2",size:"16"}):null,r.React.createElement("div",{className:"collapse-label text-truncate",title:this.props.label},this.props.label)),r.React.createElement(a.Button,{type:"tertiary",icon:!0,size:"sm",onClick:this.toggleChildDss,className:"ds-collapse-btn w-25 d-flex justify-content-end"},r.React.createElement(a.Icon,{icon:this.state.isChildDssOpen?d:c,size:"14"}))),r.React.createElement(a.Collapse,{isOpen:this.state.isChildDssOpen},l.getSortedArrayByLabel(this.props.childDss).map((function(t){return t&&t.id?r.React.createElement(i.default,{selectedDsIds:e.props.selectedDsIds,ds:t,onRemove:e.props.onRemove,key:t.id,onSelect:e.props.onSelect,intl:e.props.intl,disableSelection:e.props.disableSelection,disableRemove:e.props.disableRemove}):null})))):null},t}(r.React.PureComponent);t.default=p},705:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(422),l=n(424),c=n(147),d=n(69),p=n(194),u=function(e){function t(t){var n=e.call(this,t)||this;return n.__unmount=!1,n.initData=function(){n.setSelectedType(null),n.setToUseDataSources(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue),n.setDataSources()},n.setHasErrorDss=function(e){return n.setState({hasErrorSelectedDss:e})},n.setToUseDataSources=function(e,t,s,o){var r=n.getToUseRootDss(e,t,s,o);n.getToUseChildDss(e,t,s,o).then((function(e){n.__unmount||n.setState({toUseRootDss:r,toUseChildDss:e})}))},n.setDataSources=function(){var e=n.getToUseRootDss(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue);n.getToUseChildDss(n.props.types,n.props.fromRootDsIds,n.props.fromDsIds,n.props.searchValue).then((function(t){n.__unmount||n.setState({rootDss:e,childDss:t})}))},n.setSelectedType=function(e){n.setState({selectedTypes:e})},n.getRootDss=function(){return r.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(e){return e&&e.id&&e.dataSourceJson&&!e.parentDataSource}))},n.getToUseRootDss=function(e,t,n,s){return t?[]:r.DataSourceManager.getInstance().getConfiguredDataSources().filter((function(t){return!t.parentDataSource&&t.dataSourceJson&&c.getWhetherUseDataSource(t.dataSourceJson,e)&&d.isFuzzySearch(t.dataSourceJson,s)&&d.isFuzzyFromDsIds(t.dataSourceJson,n)}))},n.getToUseChildDss=function(e,t,s,o){var a;return a=t?t.asMutable().map((function(e){return r.DataSourceManager.getInstance().getDataSource(e)})):n.getRootDss(),c.getToUseChildDss(a,e).then((function(e){var t={};return Object.keys(e).forEach((function(n){e[n].some((function(e){return d.isFuzzySearch(e.dataSourceJson,o)&&d.isFuzzyFromDsIds(e.dataSourceJson,s)}))&&(t[n]=e[n].filter((function(e){return d.isFuzzySearch(e.dataSourceJson,o)&&d.isFuzzyFromDsIds(e.dataSourceJson,s)})))})),t}))},n.getWhetherShowList=function(){return n.getWhetherShowRootDss()||n.getWhetherShowChildDss()||!(!n.state.hasErrorSelectedDss||!n.props.selectedDsIds)},n.getWhetherShowRootDss=function(){return n.state.toUseRootDss&&n.state.toUseRootDss.length>0},n.getWhetherShowChildDss=function(){return n.state.toUseChildDss&&Object.keys(n.state.toUseChildDss).length>0},n.getRootDsLabelById=function(e){var t=n.getRootDss(),s=t&&t.find((function(t){return t.id===e}));return s&&s.label},n.getRootDsIconById=function(e){var t=n.getRootDss(),s=t&&t.find((function(t){return t.id===e})),o=s&&s.dataSourceJson;return d.getDsIcon(o)},n.state={selectedTypes:null,toUseRootDss:null,toUseChildDss:null,rootDss:null,childDss:null,hasErrorSelectedDss:!0},n}return o(t,e),t.prototype.componentDidMount=function(){this.__unmount=!1,this.props.isDataSourceInited&&this.initData()},t.prototype.componentDidUpdate=function(e,t){this.props.isDataSourceInited&&(t.selectedTypes===this.state.selectedTypes&&e.fromRootDsIds===this.props.fromRootDsIds&&e.fromDsIds===this.props.fromDsIds&&e.searchValue===this.props.searchValue||(this.state.selectedTypes?this.setToUseDataSources(this.state.selectedTypes,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue):this.setToUseDataSources(this.props.types,this.props.fromRootDsIds,this.props.fromDsIds,this.props.searchValue)),e.types===this.props.types&&!1!==e.isDataSourceInited&&e.dataSources===this.props.dataSources||this.initData())},t.prototype.componentWillUnmount=function(){this.__unmount=!0},t.prototype.render=function(){var e,t,n=c.getAddedDataTypes(this.props.types);return r.React.createElement("div",{className:"ds-added-data h-100 w-100"},n&&n.length>0?r.React.createElement("div",{className:"pt-3 h-100"},!this.props.hideTypeDropdown&&r.React.createElement("div",{className:"ds-types"},r.React.createElement(l.default,{toUseTypes:n,onTypeSelected:this.setSelectedType,selectedTypes:this.state.selectedTypes,intl:this.props.intl})),this.getWhetherShowList()?r.React.createElement(i.default,{singleDss:this.state.toUseRootDss,groupedDss:this.state.toUseChildDss,onSelect:this.props.onSelect,onRemove:this.props.onRemove,changeHasErrorSelectedDss:this.setHasErrorDss,selectedDsIds:this.props.selectedDsIds,showErrorDss:!0,disableRemove:this.props.disableRemove,disableSelection:this.props.disableSelection,intl:this.props.intl,getGroupLabelById:this.getRootDsLabelById,getGroupIconById:this.getRootDsIconById}):r.React.createElement("div",null,(null===(t=null===(e=r.getAppStore().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)&&this.props.isDataSourceInited&&r.React.createElement("div",{className:"empty-placeholder w-100"},r.React.createElement("div",{className:"empty-placeholder-icon"},r.React.createElement(a.Icon,{icon:p,width:80,height:71})),r.React.createElement("div",{className:"empty-placeholder-text",dangerouslySetInnerHTML:{__html:this.props.intl.formatMessage({id:"noAddedDataSourceCanBeUsed",defaultMessage:a.defaultMessages.noAddedDataSourceCanBeUsed})+"<br/>"+this.props.intl.formatMessage({id:"pleaseAddData",defaultMessage:a.defaultMessages.pleaseAddData})}})))):this.props.intl.formatMessage({id:"noSelectedType",defaultMessage:a.defaultMessages.noSelectedType}))},t}(r.React.PureComponent);t.default=u},706:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(294),l=n(69),c=n(35),d=n(312),p=n(313),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onRemove=function(e){n.stopPropagation(e);var t=n.props.onRemove;t&&t(n.props.dsJsonWithRootId)},n.onFilterClick=function(e){n.stopPropagation(e);var t=n.props,s=t.onClickFilter,o=t.dsJsonWithRootId;s&&s(o&&o.dataSourceJson&&o.dataSourceJson.id)},n.formatMessage=function(e,t){var s=Object.assign({},a.defaultMessages,i.defaultMessages);return n.props.intl.formatMessage({id:e,defaultMessage:s[e]},t)},n.onSortClick=function(e){n.stopPropagation(e);var t=n.props,s=t.onClickSort,o=t.dsJsonWithRootId;s&&s(o&&o.dataSourceJson&&o.dataSourceJson.id)},n.stopPropagation=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.getDsLabel=function(e){return e&&e.dataSourceJson&&(e.dataSourceJson.label||e.dataSourceJson.id)||n.formatMessage("none")},n.getWhetherItemError=function(e){var t=r.DataSourceManager.getInstance(),n=e&&e.dataSourceJson&&e.dataSourceJson.id;return!(n&&t.getDataSource(n))},n}return o(t,e),t.prototype.render=function(){var e=this.props,t=e.showFilter,n=e.showSort,s=e.hideRemove,o=e.dsJsonWithRootId,i=t||n,u=r.jsx(a.Button,{icon:!0,size:"sm",type:"tertiary",title:this.formatMessage("remove"),onClick:this.onRemove,className:"ds-item-close"},r.jsx(a.Icon,{icon:c,size:"12"}));return r.jsx("div",{className:this.props.className?"w-100 "+this.props.className:"w-100"},o&&o.dataSourceJson&&r.jsx("div",{className:r.classNames("ds-item",{"ds-error-item":this.getWhetherItemError(o),"disable-cursor":this.props.disableDsList}),onClick:this.props.onClick},i&&r.jsx("div",{className:"d-flex align-items-center justify-content-between mb-2"},r.jsx("div",{className:"icon-left"},t&&r.jsx(a.Button,{icon:!0,size:"sm",type:"tertiary",title:this.formatMessage("filters"),className:"mr-30 top-right-red-dot-container",onClick:this.onFilterClick},r.jsx(a.Icon,{icon:p,size:"12"}),this.props.haveSetFilter&&r.jsx("span",{className:"top-right-red-dot"})),n&&r.jsx(a.Button,{icon:!0,size:"sm",type:"tertiary",title:this.formatMessage("sort"),className:"top-right-red-dot-container",onClick:this.onSortClick},r.jsx(a.Icon,{icon:d,size:"12"}),this.props.haveSetSort&&r.jsx("span",{className:"top-right-red-dot"}))),!s&&u),r.jsx("div",{className:"d-flex align-items-center w-100 item"},r.jsx("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},r.jsx(a.Icon,{icon:l.getDsIcon(o.dataSourceJson),className:"text-dark",size:"12"})),r.jsx("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},r.jsx("div",{className:"text-truncate ds-type-name",title:this.getDsLabel(o)},this.getDsLabel(o))),!i&&!s&&u)))},t}(r.React.PureComponent);t.default=u},707:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(425),l=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.render=function(){var e;return this.props.dataSourceJson?a.jsx("div",{className:a.classNames((e={},e[this.props.className]=!!this.props.className,e))},a.jsx("div",{className:"component-data-source-error-item"},a.jsx(i.DataSourceItem,r({},this.props)))):null},t}(a.React.PureComponent);t.DataSourceErrorItem=a.themeUtils.withStyles(l,"DataSourceErrorItem")},708:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(709),l=n(710),c=n(711),d=n(195),p=function(e){function t(t){var n=e.call(this,t)||this;return n.initSelectedDsAndSchema=function(){var e;if(n.props.selectedFields&&n.props.dataSources)if(Array.isArray(n.props.selectedFields))e=n.props.dataSources[0];else{var t=Object.keys(n.props.selectedFields)[0];e=n.props.dataSources.find((function(e){return e&&e.id===t}))}else n.props.dataSources&&(e=n.props.dataSources[0]);e&&n.setSelectedDsAndSchema(e)},n.setSelectedDsAndSchema=function(e){e&&e.getSchema&&n.setState({selectedSchema:e.getSchema(),selectedDs:e})},n.getWhetherDisableDsDropdown=function(){return n.props.dataSources&&n.props.dataSources.length<=1},n.getDsLabel=function(e){return e&&e.dataSourceJson&&(e.dataSourceJson.label||e.dataSourceJson.id)||""},n.getSelectedFields=function(){if(!n.state.selectedDs||!n.state.selectedDs.id||!n.props.selectedFields)return r.Immutable([]);var e=Array.isArray(n.props.selectedFields)?n.props.selectedFields:r.Immutable(n.props.selectedFields[n.state.selectedDs.id]);return e?n.props.isMultiple?e:e.slice(0,1):r.Immutable([])},n.getFields=function(){if(!n.state.selectedSchema||!n.state.selectedSchema.fields)return null;if(n.state.searchValue){var e,t,s=r.Immutable({});return Object.keys(n.state.selectedSchema.fields).forEach((function(o){e=n.state.selectedSchema.fields[o].alias||n.state.selectedSchema.fields[o].name,t=n.state.selectedSchema.fields[o].type,(!n.props.types||n.props.types.some((function(e){return e===t})))&&e&&e.toLowerCase().indexOf(n.state.searchValue.toLowerCase())>-1&&(s=s.setIn([o],n.state.selectedSchema.fields[o]))})),s}if(n.props.types){var o,a=r.Immutable({});return Object.keys(n.state.selectedSchema.fields).forEach((function(e){(o=n.state.selectedSchema.fields[e].type)&&n.props.types.some((function(e){return e===o}))&&(a=a.setIn([e],n.state.selectedSchema.fields[e]))})),a}return n.state.selectedSchema.fields},n.onDsSelected=function(e){var t=e.currentTarget.value,s=n.props.dataSources&&n.props.dataSources.find((function(e){return e&&e.id===t}));n.setSelectedDsAndSchema(s)},n.onSearchChange=function(e){n.setState({searchValue:e.target.value})},n.onFieldClick=function(e){var t,s=n.getSelectedFields(),o=n.getFields();s&&s.some((function(t){return t===e.jimuName}))?n.props.isMultiple?(t=s.filter((function(t){return t!==e.jimuName})).map((function(e){return o[e]})),n.props.onRemove&&n.props.onRemove(t,e,n.state.selectedDs)):n.props.onRemove&&n.props.onRemove([],e,n.state.selectedDs):n.props.isMultiple?(t=s?s.map((function(e){return o[e]})).concat(e):[e],n.props.onSelect&&n.props.onSelect(t,e,n.state.selectedDs)):n.props.onSelect&&n.props.onSelect([e],e,n.state.selectedDs)},n.state={selectedDs:null,selectedSchema:null,searchValue:""},n}return o(t,e),t.prototype.componentDidMount=function(){this.initSelectedDsAndSchema()},t.prototype.componentDidUpdate=function(e,t){var n=this;this.props.dataSources===e.dataSources&&this.props.selectedFields===e.selectedFields||this.state.selectedDs&&this.props.selectedFields===e.selectedFields&&!this.props.dataSources.every((function(e){return e&&e.id!==n.state.selectedDs.id}))||this.initSelectedDsAndSchema()},t.prototype.render=function(){var e,t=this;if(!this.props.dataSources||0===this.props.dataSources.filter((function(e){return!!e})).length)return console.warn("No data sources"),null;var n=this.getDsLabel(this.state.selectedDs);return r.jsx("div",{style:this.props.style,className:r.classNames("w-100 h-100",(e={},e[this.props.className]=!!this.props.className,e))},r.jsx("div",{className:"component-field-selector w-100 h-100"},this.props.isDataSourceDropDownHidden?null:this.getWhetherDisableDsDropdown()?r.jsx("div",{className:"p-3 d-flex justify-content-between align-items-center"},r.jsx("div",{className:"ds-name-label mr-2 text-truncate",title:this.props.intl.formatMessage({id:"data",defaultMessage:a.defaultMessages.data})},this.props.intl.formatMessage({id:"data",defaultMessage:a.defaultMessages.data})),r.jsx("div",{className:"field-data-selected text-truncate text-right",title:n},n)):r.jsx("div",{className:"ds-name p-3 d-flex justify-content-between align-items-center",style:{display:"none"}},r.jsx("div",{className:"ds-name-label mr-2 text-truncate",title:this.props.intl.formatMessage({id:"data",defaultMessage:a.defaultMessages.data})},this.props.intl.formatMessage({id:"data",defaultMessage:a.defaultMessages.data})),r.jsx(a.Select,{value:this.state.selectedDs&&this.state.selectedDs.id||"",onChange:this.onDsSelected,className:"flex-shrink-0 ds-name-selected text-truncate"},this.props.dataSources&&this.props.dataSources.map((function(e,n){return e&&r.jsx("option",{value:e.id,key:n,className:"ds-name-selected text-truncate"},t.getDsLabel(e))})))),this.props.isSearchInputHidden?null:r.jsx("div",{className:"d-inline-block w-100 px-3 mb-3 item-selector-search"},r.jsx(a.Icon,{icon:d,className:"search-icon",color:this.props.theme.colors.dark}),r.jsx(a.TextInput,{placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:r.defaultMessages.search}),onChange:this.onSearchChange,className:"d-inline-block search-input",value:this.state.searchValue})),this.props.useDropdown?r.jsx("div",null,this.props.isMultiple?r.jsx(c.default,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getFields(),selectedFields:this.getSelectedFields(),onFieldClick:this.onFieldClick,theme:this.props.theme}):r.jsx(l.default,{placeHolder:this.props.placeHolder,ds:this.state.selectedDs,fields:this.getFields(),selectedFields:this.getSelectedFields(),onFieldClick:this.onFieldClick,theme:this.props.theme})):r.jsx(i.default,{ds:this.state.selectedDs,fields:this.getFields(),selectedFields:this.getSelectedFields(),isMultiple:this.props.isMultiple,onFieldClick:this.onFieldClick,theme:this.props.theme})))},t}(r.React.PureComponent);t.FieldSelector=r.themeUtils.withStyles(r.themeUtils.withTheme(r.injectIntl(p)),"FieldSelector")},709:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(317),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;return t&&this.props.ds?r.React.createElement("div",{className:"field-list px-3"},t&&Object.keys(t).map((function(n){var s=i.getIconFromFieldType(t[n].type,e.props.theme);return r.React.createElement("div",{key:n,onClick:function(){e.props.onFieldClick(t[n])},className:r.classNames("field-item mt-2 p-1",{"field-item-selected":e.props.selectedFields&&(e.props.isMultiple?e.props.selectedFields.some((function(e){return e===n})):n===e.props.selectedFields[0])})},r.React.createElement(a.Icon,{icon:s.icon,color:s.color,className:"d-inline-block mr-2",size:16}),r.React.createElement("span",null,t[n].alias||t[n].name))}))):null},t}(r.React.PureComponent);t.default=l},710:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(317),l=function(e){function t(t){var n=e.call(this,t)||this;return n.toggle=function(){n.setState({isOpen:!n.state.isOpen})},n.getSelectedFieldJimuName=function(){var e,t=n.props.fields;if(t&&n.props.selectedFields&&n.props.selectedFields[0])return null===(e=t[n.props.selectedFields[0]])||void 0===e?void 0:e.jimuName},n.state={isOpen:!1},n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.fields;return t&&this.props.ds?r.React.createElement("div",null,r.React.createElement(a.Select,{value:this.getSelectedFieldJimuName(),fluid:!0,isOpen:this.state.isOpen,toggle:this.toggle,className:"field-dropdown",placeholder:this.props.placeHolder,onChange:function(n){e.props.onFieldClick(t[n.currentTarget.value])}},t&&Object.keys(t).map((function(n,s){var o=i.getIconFromFieldType(t[n].type,e.props.theme);return r.React.createElement(a.Option,{key:s,value:n},r.React.createElement(a.Icon,{icon:o.icon,color:o.color,className:"d-inline-block mr-2",size:16}),r.React.createElement("span",null,t[n].alias||t[n].name))})))):null},t}(r.React.PureComponent);t.default=l},711:function(e,t,n){"use strict";var s,o=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(3),i=n(317),l=function(e){function t(t){var n=e.call(this,t)||this;return n.onFieldClick=function(e,t){var s=n.props.fields[t];n.props.onFieldClick(s)},n.getMultiSelectItems=function(){if(n.props.fields){var e=[];return Object.keys(n.props.fields).forEach((function(t){e.push({value:t,label:n.props.fields[t].alias||n.props.fields[t].name,render:function(e){var s=i.getIconFromFieldType(n.props.fields[t].type,n.props.theme);return r.React.createElement("div",{className:"d-flex w-100 align-items-center"},r.React.createElement(a.Checkbox,{checked:n.props.selectedFields.indexOf(e.value)>-1}),r.React.createElement(a.Icon,{icon:s.icon,color:s.color,className:"d-inline-block mr-2 ml-2",size:16}),r.React.createElement("span",null,n.props.fields[t].alias||n.props.fields[t].name))}})})),e}return[]},n}return o(t,e),t.prototype.render=function(){return this.props.fields&&this.props.ds?r.React.createElement("div",null,r.React.createElement(a.MultiSelect,{fluid:!0,items:r.Immutable(this.getMultiSelectItems()),onClickItem:this.onFieldClick,values:this.props.selectedFields})):null},t}(r.React.PureComponent);t.default=l}})}));